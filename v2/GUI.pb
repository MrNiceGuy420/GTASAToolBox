Enumeration
 #Window_BetaInfo
 #Window_Splash
 #Window_RunOnlyOnceCheckWindow
 #Window_Language
 #Window_Main
 #Window_MDI_Cheats
 #Window_MDI_Teleporter
 #Window_MDI_SavegameManager
 #Window_MDI_Models
 #Window_MDI_MemoryChanger
 #Window_MDI_IMGEditor
 #Window_MDI_CleoManager
 #Window_MDI_IPLEditor
 #Window_MDI_GameTweaks
 #Window_MDI_Config
 #Window_MDI_TeleportMap
 #Window_MDI_Tools
 #Window_MDI_Help
 #Window_MDI_ChangeLog
 #Window_About
 #Window_AddCheat
 #Window_Updater
 #Window_GTAList
 #Window_Login
EndEnumeration

Enumeration
 #Menu_Main
 #Menu_Main_Login
 #Menu_Main_RunScript
 #Menu_Main_Quit
 #Menu_Main_Cheats
 #Menu_Main_Teleporter
 #Menu_Main_SavegameManager
 #Menu_Main_Models
 #Menu_Main_MemoryChanger
 #Menu_Main_IMGEditor
 #Menu_Main_CleoManager
 #Menu_Main_IPLEditor
 #Menu_Main_GameTweaks
 #Menu_Main_Config
 #Menu_Main_Tools
 #Menu_Main_RunCheatProcessor
 #Menu_Main_RunMemoryServer
 #Menu_Main_RunWebServer
 #Menu_Main_Help
 #Menu_Main_SearchUpdates
 #Menu_Main_ReportBug
 #Menu_Main_ChangeLog
 #Menu_Main_About
 #Menu_Main_StartGTASA
 #Menu_Panel
 #Menu_Panel_UseTabs
 #Menu_Models
 #Menu_CleoManager
 #Menu_CleoManager_LargeIcon
 #Menu_CleoManager_SmallIcon
 #Menu_CleoManager_List
 #Menu_CleoManager_Detail
 #Menu_IPLEditor
 #Menu_IPLEditor_EditID
 #Menu_IPLEditor_EditModel
 #Menu_IPLEditor_EditInterior
 #Menu_IPLEditor_EditX
 #Menu_IPLEditor_EditY
 #Menu_IPLEditor_EditZ
 #Menu_IPLEditor_EditUnknown1
 #Menu_IPLEditor_EditUnknown2
 #Menu_IPLEditor_EditUnknown3
 #Menu_IPLEditor_EditUnknown4
 #Menu_IPLEditor_EditLOD
 #Menu_Login_OK
 #Menu_Login_Cancel
 #ToolBar_Cheats_Save
 #ToolBar_Cheats_Add
 #ToolBar_Cheats_Remove
 #ToolBar_Cheats_Edit
 #ToolBar_Cheats_Print
 #ToolBar_Cheats_Export
 #ToolBar_Teleporter_Save
 #ToolBar_Teleporter_Add
 #ToolBar_Teleporter_Remove
 #ToolBar_Teleporter_Edit
 #ToolBar_Teleporter_ReadMemory
 #ToolBar_Teleporter_ShowMap
 #ToolBar_Teleporter_Goto
 #ToolBar_Teleporter_Savegame
 #ToolBar_SavegameManager_Save
 #ToolBar_SavegameManager_Edit
 #ToolBar_SavegameManager_CreateBackup
 #ToolBar_SavegameManager_RestoreBackup
 #ToolBar_SavegameManager_Refresh
 #ToolBar_Models_Save
 #ToolBar_Models_Edit
 #ToolBar_Models_AddAsCheat
 #ToolBar_Models_Spawn
 #ToolBar_Models_Refresh
 #ToolBar_MemoryChanger_Save
 #ToolBar_MemoryChanger_Add
 #ToolBar_MemoryChanger_Set
 #ToolBar_MemoryChanger_Remove
 #ToolBar_MemoryChanger_Clear
 #ToolBar_MemoryChanger_ReadMemory
 #ToolBar_MemoryChanger_WriteMemory
 #ToolBar_MemoryChanger_ConnectTo
 #ToolBar_IMGEditor_Open
 #ToolBar_IMGEditor_Export
 #ToolBar_IMGEditor_Replace
 #ToolBar_IMGEditor_Delete
 #ToolBar_IMGEditor_Insert
 #ToolBar_GameTweaks_Read
 #ToolBar_GameTweaks_Write
 #ToolBar_Config_Save
 #ToolBar_Tools_Add
 #ToolBar_Tools_Remove
 #ToolBar_Tools_Edit
 #ToolBar_Tools_AddBar
 #ToolBar_Tools_OpenSubMenu
 #ToolBar_Tools_CloseSubMenu
 #ToolBar_Tools_MoveUp
 #ToolBar_Tools_MoveDown
 #ToolBar_Tools_RefreshMenu
 #ToolBar_Help_Back
 #ToolBar_Help_Next
 #ToolBar_Help_Home
 #Menu_ExportCheats
 #Menu_ExportCheats_Excel
 #Menu_ExportCheats_Html
 #Menu_SavegameTeleporter
 #Menu_SavegameTeleporter_ReadSlot1
 #Menu_SavegameTeleporter_ReadSlot2
 #Menu_SavegameTeleporter_ReadSlot3
 #Menu_SavegameTeleporter_ReadSlot4
 #Menu_SavegameTeleporter_ReadSlot5
 #Menu_SavegameTeleporter_ReadSlot6
 #Menu_SavegameTeleporter_ReadSlot7
 #Menu_SavegameTeleporter_ReadSlot8
 #Menu_SavegameTeleporter_WriteSlot1
 #Menu_SavegameTeleporter_WriteSlot2
 #Menu_SavegameTeleporter_WriteSlot3
 #Menu_SavegameTeleporter_WriteSlot4
 #Menu_SavegameTeleporter_WriteSlot5
 #Menu_SavegameTeleporter_WriteSlot6
 #Menu_SavegameTeleporter_WriteSlot7
 #Menu_SavegameTeleporter_WriteSlot8
 #Menu_Models_Radio
 #Menu_Models_EditName
 #Menu_Tools
 #Menu_Tools_EditName
 #Menu_Tools_EditFile
 #Menu_Tools_EditParameter
 #Menu_Tray
 #Menu_Tray_ShowWindow
 #Menu_Tray_StartGTASA
 #Menu_StartGTASA
 #menu_StartGTASA_Install1
 #menu_StartGTASA_Install2
 #menu_StartGTASA_Install3
 #menu_StartGTASA_Install4
 #menu_StartGTASA_Install5
 #menu_StartGTASA_Install6
 #menu_StartGTASA_Install7
 #menu_StartGTASA_Install8
 #menu_StartGTASA_Install9
 #menu_StartGTASA_Install10
 #Menu_FirstExternTool
EndEnumeration

Enumeration #Menu_FirstExternTool+100
 #Menu_FirstMDI
EndEnumeration

Enumeration
 #ToolBar_Cheats
 #ToolBar_Teleporter
 #ToolBar_SavegameManager
 #ToolBar_Models
 #ToolBar_MemoryChanger
 #ToolBar_IMGEditor
 #ToolBar_CleoManager
 #ToolBar_GameTweaks
 #ToolBar_Config
 #ToolBar_Tools
 #ToolBar_Help
EndEnumeration

Enumeration
 #Gadget_Language_Text
 #Gadget_Language_UseEnglish
 #Gadget_Language_UseGerman
 #Gadget_BetaInfo_Text
 #Gadget_BetaInfo_DoNotShowAgain
 #Gadget_BetaInfo_Start
 #Gadget_BetaInfo_Quit
 #Gadget_Splash_Image
 #Gadget_Splash_Text
 #Gadget_Main_Panel
 #Gadget_Main_MDI
 #Gadget_Cheats_List
 #Gadget_Teleporter_EditContainer
 #Gadget_Teleporter_Text1
 #Gadget_Teleporter_Text2
 #Gadget_Teleporter_Text3
 #Gadget_Teleporter_Text4
 #Gadget_Teleporter_Text5
 #Gadget_Teleporter_EditCheat
 #Gadget_Teleporter_EditX
 #Gadget_Teleporter_EditY
 #Gadget_Teleporter_EditZ
 #Gadget_Teleporter_EditInterior
 #Gadget_Teleporter_List
 #Gadget_SavegameManager_List
 #Gadget_SavegameManager_EditArea
 #Gadget_SavegameManager_Editor_Text1
 #Gadget_SavegameManager_Editor_Text2
 #Gadget_SavegameManager_Editor_Text3
 #Gadget_SavegameManager_Editor_Text4
 #Gadget_SavegameManager_Editor_Text5
 #Gadget_SavegameManager_Editor_Name
 #Gadget_SavegameManager_Editor_Money
 #Gadget_SavegameManager_Editor_MaxHealth
 #Gadget_SavegameManager_Editor_MaxArmor
 #Gadget_SavegameManager_Editor_Clock
 #Gadget_Models_Panel
 #Gadget_Models_VehicleList
 #Gadget_Models_WeaponList
 #Gadget_Models_ImageContainer
 #Gadget_Models_Image
 #Gadget_Models_Splitter
 #Gadget_MemoryChanger_EditContainer
 #Gadget_MemoryChanger_Text1
 #Gadget_MemoryChanger_Text2
 #Gadget_MemoryChanger_Text3
 #Gadget_MemoryChanger_Text4
 #Gadget_MemoryChanger_Name
 #Gadget_MemoryChanger_Address
 #Gadget_MemoryChanger_DataType
 #Gadget_MemoryChanger_Value
 #Gadget_MemoryChanger_List
 #Gadget_IMGEditor_List
 #Gadget_IMGEditor_Progress
 #Gadget_CleoManager_List
 #Gadget_IPLEditor_Files
 #Gadget_IPLEditor_Save
 #Gadget_IPLEditor_List
 #Gadget_GameTweaks_Panel
 #Gadget_GameTweaks_StatisticScroll
 #Gadget_GameTweaks_Text1
 #Gadget_GameTweaks_Text2
 #Gadget_GameTweaks_Text3
 #Gadget_GameTweaks_Text4
 #Gadget_GameTweaks_Text5
 #Gadget_GameTweaks_Text6
 #Gadget_GameTweaks_Text7
 #Gadget_GameTweaks_Text8
 #Gadget_GameTweaks_Text9
 #Gadget_GameTweaks_Text10
 #Gadget_GameTweaks_Text11
 #Gadget_GameTweaks_Text12
 #Gadget_GameTweaks_Text13
 #Gadget_GameTweaks_Text14
 #Gadget_GameTweaks_Text15
 #Gadget_GameTweaks_PistolState
 #Gadget_GameTweaks_SilencedPistolState
 #Gadget_GameTweaks_DesertEagleState
 #Gadget_GameTweaks_ShotgunState
 #Gadget_GameTweaks_SawnoffShotgunState
 #Gadget_GameTweaks_CombatShotgunState
 #Gadget_GameTweaks_MachinePistolState
 #Gadget_GameTweaks_SMGState
 #Gadget_GameTweaks_AK47State
 #Gadget_GameTweaks_M4State
 #Gadget_GameTweaks_FatState
 #Gadget_GameTweaks_StaminaState
 #Gadget_GameTweaks_MuscleState
 #Gadget_GameTweaks_HealthState
 #Gadget_GameTweaks_SexAppealState
 #Gadget_GameTweaks_GirlfriendsScroll
 #Gadget_GameTweaks_Text16
 #Gadget_GameTweaks_Text17
 #Gadget_GameTweaks_Text18
 #Gadget_GameTweaks_Text19
 #Gadget_GameTweaks_Text20
 #Gadget_GameTweaks_Text21
 #Gadget_GameTweaks_DeniseState
 #Gadget_GameTweaks_MichelleState
 #Gadget_GameTweaks_HelenaState
 #Gadget_GameTweaks_BarbaraState
 #Gadget_GameTweaks_KatieState
 #Gadget_GameTweaks_MillieState
 #Gadget_TeleportMap_ScrollArea
 #Gadget_TeleportMap_Image
 #Gadget_Config_ScrollArea
 #Gadget_Config_FrameGeneral
 #Gadget_Config_RememberMDI
 #Gadget_Config_MinimizeToTray
 #Gadget_Config_StartMinimized
 #Gadget_Config_DisplayMessages
 #Gadget_Config_QuitConfirm
 #Gadget_Config_UseTabs
 #Gadget_Config_DisableGTASplash
 #Gadget_Config_CloseModulesOnQuit
 #Gadget_Config_AutoCheckUpdates
 #Gadget_Config_AutoSaveData
 #Gadget_Config_FrameCheatSound
 #Gadget_Config_UseCheatSound
 #Gadget_Config_CheatSound
 #Gadget_Config_OpenCheatSound
 #Gadget_Config_FrameLanguage
 #Gadget_Config_Language
 #Gadget_Config_GTA
 #Gadget_Config_GTAFile
 #Gadget_Config_OpenGTAFile
 #Gadget_Config_FrameServer
 #Gadget_Config_Text1
 #Gadget_Config_ServerPort
 #Gadget_Config_FrameCheatProcessor
 #Gadget_Config_CheatProcessorList
 #Gadget_Config_CheatProcessorAdd
 #Gadget_Config_CheatProcessorRemove
 #Gadget_Config_CheatProcessorClear
 #Gadget_Config_FrameImageType
 #Gadget_Config_ImageTypeBMP
 #Gadget_Config_ImageTypeJPG
 #Gadget_Config_ImageTypePNG
 #Gadget_Config_FrameMapType
 #Gadget_Config_MapType2D
 #Gadget_Config_MapType3D
 #Gadget_Config_FrameFileTypes
 #Gadget_Config_FileTypesList
 #Gadget_Config_FrameStartup
 #Gadget_Config_StartupCheatProcessor
 #Gadget_Config_StartupMemoryServer
 #Gadget_Config_StartupWebServer
 #Gadget_Config_FrameBackground
 #Gadget_Config_UseBackground
 #Gadget_Config_Background
 #Gadget_Config_OpenBackground
 #Gadget_About_Banner
 #Gadget_About_Text
 #Gadget_About_Close
 #Gadget_AddCheat_Text1
 #Gadget_AddCheat_Text2
 #Gadget_AddCheat_Text3
 #Gadget_AddCheat_Text4
 #Gadget_AddCheat_Cheat
 #Gadget_AddCheat_Description
 #Gadget_AddCheat_HotkeyCtrl
 #Gadget_AddCheat_HotkeyShift
 #Gadget_AddCheat_HotkeyAlt
 #Gadget_AddCheat_Hotkey
 #Gadget_AddCheat_Sound
 #Gadget_AddCheat_CheatSelect
 #Gadget_AddCheat_SoundSelect
 #Gadget_AddCheat_OK
 #Gadget_AddCheat_Cancel
 #Gadget_AddCheat_CheatSelectBox
 #Gadget_Help_Frame
 #Gadget_Help_Files
 #Gadget_Help_Web
 #Gadget_Help_Splitter
 #Gadget_ChangeLog_Text
 #Gadget_Updater_StatusText
 #Gadget_Updater_Text1
 #Gadget_Updater_File
 #Gadget_Updater_Text2
 #Gadget_Updater_TotalSize
 #Gadget_Updater_FileStatus
 #Gadget_Updater_TotalStatus
 #Gadget_Updater_Start
 #Gadget_Updater_ShowFileList
 #Gadget_Updater_Close
 #Gadget_Updater_FileList
 #Gadget_Tools_List
 #Gadget_GTAList_List
 #Gadget_Login_Text1
 #Gadget_Login_Text2
 #Gadget_Login_Username
 #Gadget_Login_Password
 #Gadget_Login_SavePassword
 #Gadget_Login_OK
 #Gadget_Login_Cancel
EndEnumeration

Enumeration
 #Tab_Cheats
 #Tab_Teleporter
 #Tab_SavegameManager
 #Tab_Models
 #Tab_MemoryChanger
 #Tab_IMGEditor
 #Tab_CleoManager
 #Tab_IPLEditor
 #Tab_GameTweaks
 #Tab_Config
EndEnumeration

Enumeration
 #Font_404Image
 #Font_Default
 #Font_Bold
 #Font_Printer
EndEnumeration

Enumeration
 #Tray
EndEnumeration

Enumeration
 #StatusBar
EndEnumeration

Enumeration
 #Tools_DefaultItem
 #Tools_Separator
 #Tools_OpenSubMenu
 #Tools_CloseSubMenu
EndEnumeration

Enumeration
 #UpdateType_Updated
 #UpdateType_New
EndEnumeration

Enumeration
 #Vehicle_Unknown
 #Vehicle_Bike
 #Vehicle_BMX
 #Vehicle_Boat
 #Vehicle_Car
 #Vehicle_Heli
 #Vehicle_Monstertruck
 #Vehicle_Trailer
 #Vehicle_Train
 #Vehicle_Plane
 #Vehicle_Quad
EndEnumeration

Structure TextZoneData
 x.f
 y.f
 Color.l
EndStructure

Structure TextZoneConfig
 VehicleDamage.TextZoneData
 VehicleSpeed.TextZoneData
 Timer.TextZoneData
 SpawnVehicle.TextZoneData
EndStructure

Structure CheatProcessorKey
 SpawnVehicleEx.l
 ScrollVehicleUp.l
 ScrollVehicleDown.l
EndStructure

Structure HeaderImage
 Empty.l
 ArrowUp.l
 ArrowDown.l
EndStructure

Structure SelfCodersAccount
 LoggedIn.b
 Username.s
 Password.s
EndStructure

Structure HigherProcessPriority
 CheatProcessor.b
 GUI.b
 MemoryServer.b
 WebServer.b
EndStructure

Structure Config
 GTAUserFiles.s
 HelpDir.s
 WindowFile.s
 RememberMDI.b
 MinimizeToTray.b
 StartMinimized.b
 DisplayMessages.b
 UseTabs.b
 DisableGTASplash.b
 CloseModulesOnQuit.b
 AutoCheckUpdates.b
 AutoSaveData.b
 ShowBetaInfo.b
 UseCheatSound.b
 CheatSound.s
 UseBackground.b
 BackgroundFile.s
 CleoManager_ListDisplay.l
 Server_AdminPassword.s
 Server_UserPassword.s
 Server_Port.l
 MemoryNetwork_Port.l
 ActivateCheat.s
 Language.b
 IconSize.l
 Startup_CheatProcessor.b
 Startup_MemoryServer.b
 Startup_WebServer.b
 HigherProcessPriority.HigherProcessPriority
 IgnoreList_Vehicles.s
 IgnoreList_Cheats.s
 LoadID3Tag_Startup.b
 LoadID3Tag_Refresh.b
 TextZone.TextZoneConfig
 QuitConfirm.b
 ImageType.l
 MapType.l
 SmartWindowRefresh.b
 CheatProcessorKey.CheatProcessorKey
 OpenIMG_ThreadID.l
 Teleportmap_X.l
 Teleportmap_Y.l
 Cheats_HeaderImage.HeaderImage
 IMGEditor_HeaderImage.HeaderImage
 IMGEditor_ArchiveFile.s
 IMGEditor_ArchiveChanged.b
 MDIWindow.l
 IPLEditor_Changed.b
 IPLEditor_File.s
 Thread_RefreshUserTrackList.l
 HelpTopic.s
 Updater_Url.s
 Updater_Restart.b
 Updater_TotalSize.l
 LoadGadgetData.l
 StartTime.l
 SelfCodersAccount.SelfCodersAccount
 CanUseNetwork.b
 Quit.b
EndStructure

Structure Window
 Show.b
 State.l
 x.l
 y.l
 Width.l
 Height.l
EndStructure

Structure Windows
 Main.Window
 Cheats.Window
 Teleporter.Window
 SavegameManager.Window
 Models.Window
 MemoryChanger.Window
 IMGEditor.Window
 CleoManager.Window
 IPLEditor.Window
 GameTweaks.Window
 Config.Window
EndStructure

Structure Hotkey
 Ctrl.l
 Shift.l
 Alt.l
 Hotkey.l
EndStructure

Structure SortType
 Column.l
 Type.l
EndStructure

Structure CheatsSort
 Cheat.s
 Description.s
 Shortcut.s
 Sound.s
 HotkeyData.l
EndStructure

Structure IMGFiles
 Name.s
 Offset.l
 Size.l
 Type.s
EndStructure

Structure ToolsTemp
 Name.s
 File.s
 Parameter.s
 Type.l
EndStructure

Structure SaveGamePack
 Offset.l
 Size.l
EndStructure

Structure UpdateFile
 File.s
 MD5.s
 Type.l
 Size.l
 ForceReplace.l
EndStructure

Structure LVCOLUMN2
 lv.LV_COLUMN
 iImage.l
 iOrder.l
EndStructure

Structure HelpPage
 File.s
 Name.s
 Level.l
 IsSubLevel.b
EndStructure

Structure Vehicles
 ID.l
 Type.l
 Radio.b
EndStructure

Structure VehiclesTemp
 ID.l
 Name.s
 Type.s
 Radio.s
 DataStream.l
 Enabled.l
EndStructure

Structure EditorStyle_TextHeader
 Found.b
 Line.l
 Char.l
EndStructure

Structure EditorStyle_TextData
 HeaderStart.EditorStyle_TextHeader
 HeaderEnd.EditorStyle_TextHeader
EndStructure

Define.f x,y,z

Global DebugThisApp
Global Config.Config
Global Windows.Windows
Global EditorStyle_TextData.EditorStyle_TextData
Global Dim LanguageArray.s(0)
Global Dim Key(255)
Global Dim KeyName.s(255)
Global Dim Vehicle.s(211)
Global Dim Interior.s(18)
Global Dim GTAStartMenu.s(9)
Global Dim SaveGamePack.SaveGamePack(8)
Global NewList UpdateFile.UpdateFile()
Global NewList CheatsSort.CheatsSort()
Global NewList IMGFiles.IMGFiles()
Global NewList ToolsTemp.ToolsTemp()
Global NewList Vehicles.Vehicles()
Global NewList VehiclesTemp.VehiclesTemp()
Global NewList HelpPage.HelpPage()
Global NewList PictureViewer.s()
Global NewList MenuImage()
Global NewList MDIWindow()
Global NewList Update_ListRedo()
Global NewList ExportHtml.s()

IncludeFile "ResourceDll.pbi"
IncludeFile "Common.pbi"
IncludeFile "GUI_Language.pbi"
IncludeFile "GUI.pbi"

ReDim LanguageArray.s(#MaxLang)

;- Main
Config\WindowFile=Common\InstallPath+"Windows.dat"
Config\GTAUserFiles=GetPath(5)+"GTA San Andreas User Files\"
Config\StartTime=ElapsedMilliseconds()

If FindString(LCase(Common\Parameter),"/updatecheck",0)
 If OpenConsole()
  Print(MD5FileFingerprint(ProgramFilename()))
 EndIf
 End
EndIf

If InitNetwork()
 Config\CanUseNetwork=1
EndIf

UseJPEGImageDecoder()
UseJPEG2000ImageDecoder()
UseTGAImageDecoder()
UsePNGImageDecoder()
UseTIFFImageDecoder()

OpenPreferences(Common\PrefsFile)
 PreferenceGroup("Global")
  Config\Language=ReadPreferenceLong("Language",-1)
  Config\SmartWindowRefresh=ReadPreferenceLong("SmartWindowRefresh",1)
  Config\IconSize=ReadPreferenceLong("IconSize",32)
  Config\AutoCheckUpdates=ReadPreferenceLong("AutoCheckUpdates",1)
  Config\ShowBetaInfo=ReadPreferenceLong("ShowBetaInfo",1)
 PreferenceGroup("HigherProcessPriority")
  Config\HigherProcessPriority\GUI=ReadPreferenceLong("GUI",0)
ClosePreferences()

HigherProcessPriority(Config\HigherProcessPriority\GUI)

If IsParameter("/debug")
 DebugThisApp=1
 MessageRequester("Debugger","Debugging is activated")
EndIf

If IsParameter("/createstartmenu")
 StartmenuPath$=GetPath(23)+"SelfCoders\GTA San Andreas ToolBox\"
 If CreateDirectoryEx(StartmenuPath$)
  CreateShortcut(Common\InstallPath+"GTA ToolBox.exe",StartmenuPath$+"GUI.lnk","","GTA San Andreas ToolBox GUI",Common\InstallPath,#SW_SHOWNORMAL,Common\InstallPath+"GTA ToolBox.exe",0)
  CreateShortcut(Common\InstallPath+"CheatProcessor.exe",StartmenuPath$+"CheatProcessor.lnk","","GTA San Andreas ToolBox CheatProcessor",Common\InstallPath,#SW_SHOWNORMAL,Common\InstallPath+"CheatProcessor.exe",0)
  CreateShortcut(Common\InstallPath+"WebServer.exe",StartmenuPath$+"WebServer.lnk","","GTA San Andreas ToolBox WebServer",Common\InstallPath,#SW_SHOWNORMAL,Common\InstallPath+"WebServer.exe",0)
  If CreateDirectoryEx(StartmenuPath$+"Help\")
   CreateShortcut(Common\InstallPath+"Help\English.chm",StartmenuPath$+"Help\English.lnk","Help\English.tbh","GTA San Andreas ToolBox HelpViewer",Common\InstallPath,#SW_SHOWNORMAL,Common\InstallPath+"Help\English.chm",0)
   CreateShortcut(Common\InstallPath+"Help\German.chm",StartmenuPath$+"Help\Deutsch.lnk","Help\German.tbh","GTA San Andreas ToolBox HelpViewer",Common\InstallPath,#SW_SHOWNORMAL,Common\InstallPath+"Help\German.chm",0)
   MessageRequester("Information","Startmenu created!",#MB_ICONINFORMATION)
  EndIf
 EndIf
 End
EndIf

LoadLanguage()

If IsParameter("/rungta")
 RunGTA=1
EndIf

If IsModuleRunning(#Module_GUI)
 If RunGTA
  SendMessage(#Module_GUI,#Module_CMD_RunGTA)
 Else
  SendMessage(#Module_GUI,#Module_CMD_Restore)
 EndIf
 End
Else
 If RunGTA
  RunGTA()
 EndIf
EndIf
OpenWindow(#Window_RunOnlyOnceCheckWindow,0,0,0,0,#RunOnlyOnceTitle_GUI,#PB_Window_Invisible)

If Config\ShowBetaInfo
 If OpenWindow(#Window_BetaInfo,100,100,470,150,"GTA San Andreas ToolBox",#PB_Window_ScreenCentered)
  StringGadget(#Gadget_BetaInfo_Text,10,10,WindowWidth(#Window_BetaInfo)-20,WindowHeight(#Window_BetaInfo)-90,ReplaceString(Language(230),"<br>",Chr(13)+Chr(10),1),#PB_String_ReadOnly|#PB_String_BorderLess|#ES_MULTILINE)
  CheckBoxGadget(#Gadget_BetaInfo_DoNotShowAgain,10,GadgetHeight(#Gadget_BetaInfo_Text)+20,WindowWidth(#Window_BetaInfo)-20,20,Language(231))
  ButtonGadget(#Gadget_BetaInfo_Start,10,WindowHeight(#Window_BetaInfo)-40,100,30,"Start")
  ButtonGadget(#Gadget_BetaInfo_Quit,WindowWidth(#Window_BetaInfo)-110,WindowHeight(#Window_BetaInfo)-40,100,30,Language(8))
  LoadFont(#Font_Default,"Arial",8)
  LoadFont(#Font_Bold,"Arial Black",12)
  SetGadgetFont(#Gadget_BetaInfo_Text,FontID(#Font_Default))
  SetGadgetFont(#Gadget_BetaInfo_DoNotShowAgain,FontID(#Font_Default))
  SetGadgetFont(#Gadget_BetaInfo_Start,FontID(#Font_Bold))
  SetGadgetFont(#Gadget_BetaInfo_Quit,FontID(#Font_Bold))
  Repeat
   Select WaitWindowEvent()
    Case #PB_Event_Gadget
     Select EventGadget()
      Case #Gadget_BetaInfo_DoNotShowAgain
       DisableGadget(#Gadget_BetaInfo_Quit,GetGadgetState(#Gadget_BetaInfo_DoNotShowAgain))
      Case #Gadget_BetaInfo_Start
       Config\ShowBetaInfo=ChangeVal(GetGadgetState(#Gadget_BetaInfo_DoNotShowAgain))
       CloseWindow(#Window_BetaInfo)
       RunApp=1
      Case #Gadget_BetaInfo_Quit
       End
     EndSelect
   EndSelect
  Until RunApp
  EndIf
EndIf

If IsFileEx(Common\InstallPath+"Update\"+GetFilePart(ProgramFilename()))
 RunProgram(Common\InstallPath+"UpdateGUI.exe","/RunGUI",Common\InstallPath)
 End
EndIf

If Config\IconSize<1
 Config\IconSize=32
EndIf

If Config\AutoCheckUpdates
 CheckProtectedUpdates("")
 CheckUpdates(1)
EndIf

If Config\Updater_Restart
 RunProgram(ProgramFilename(),Common\Parameter,Common\InstallPath)
 End
EndIf

Stop=0
Dll=OpenLibrary(#PB_Any,Common\InstallPath+"Resources.dll")
 If IsLibrary(Dll)
  Function=GetFunction(Dll,"GetImage")
   If Function
    For Image=#Image_Splash To #Image_AboutBanner
     Memory=CallFunctionFast(Function,Image)
      If Memory
       CatchImage(Image,Memory)
      EndIf
    Next
   Else
    MessageRequester(Language(19),ReplaceString(Language(228),"%1","GetImage",1),#MB_ICONERROR)
    Stop=1
   EndIf
  CloseLibrary(Dll)
 Else
  MessageRequester(Language(19),ReplaceString(Language(229),"<br>",Chr(13),1),#MB_ICONERROR)
  Stop=1
 EndIf
If Stop
 End
EndIf

If IsParameter("/nosplash")=0
 If OpenWindow(#Window_Splash,0,0,ImageWidth(#Image_Splash),ImageHeight(#Image_Splash),"Loading...",#PB_Window_BorderLess|#PB_Window_ScreenCentered|#PB_Window_Invisible)
  StickyWindow(#Window_Splash,1)
  SetWindowLong_(WindowID(#Window_Splash),#GWL_EXSTYLE,#WS_EX_TOOLWINDOW)
  ShowWindow_(WindowID(#Window_Splash),#SW_SHOW)
  ImageGadget(#Gadget_Splash_Image,0,0,ImageWidth(#Image_Splash),ImageHeight(#Image_Splash),ImageID(#Image_Splash))
 EndIf
EndIf

Init()

If IsFileEx(Common\InstallPath+"Startup.satbs")
 RunProgram(Common\InstallPath+"Script.exe",Common\InstallPath+"Startup.satbs",Common\InstallPath)
EndIf

If OpenWindow(#Window_Main,0,0,0,0,"GTA San Andreas ToolBox",#PB_Window_MinimizeGadget|#PB_Window_MaximizeGadget|#PB_Window_SizeGadget|#PB_Window_Invisible)
 If CreateStatusBar(#StatusBar,WindowID(#Window_Main))
  StatusBarText(#StatusBar,0,"Welcome")
 EndIf
 PanelGadget(#Gadget_Main_Panel,0,0,WindowWidth(#Window_Main),20)
  AddGadgetItem(#Gadget_Main_Panel,#Tab_Cheats,Language(0))
  AddGadgetItem(#Gadget_Main_Panel,#Tab_Teleporter,"Teleporter")
  AddGadgetItem(#Gadget_Main_Panel,#Tab_SavegameManager,"SavegameManager")
  AddGadgetItem(#Gadget_Main_Panel,#Tab_Models,Language(68))
  AddGadgetItem(#Gadget_Main_Panel,#Tab_MemoryChanger,"MemoryChanger")
  AddGadgetItem(#Gadget_Main_Panel,#Tab_IMGEditor,"IMG Editor")
  AddGadgetItem(#Gadget_Main_Panel,#Tab_CleoManager,"CleoManager")
  AddGadgetItem(#Gadget_Main_Panel,#Tab_IPLEditor,"IPL Editor")
  AddGadgetItem(#Gadget_Main_Panel,#Tab_GameTweaks,"GameTweaks")
  AddGadgetItem(#Gadget_Main_Panel,#Tab_Config,Language(24))
 CloseGadgetList()
 MDIGadget(#Gadget_Main_MDI,0,20,WindowWidth(#Window_Main),WindowHeight(#Window_Main)-MenuHeight()-StatusBarHeight(#StatusBar)-20,-1,#Menu_FirstMDI)
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_Cheats,500,300,Language(0),#PB_Window_All,#Image_Cheats)
   If CreateToolBarEx(#ToolBar_Cheats,WindowID(#Window_MDI_Cheats))
    ToolBarImageButtonEx(#ToolBar_Cheats_Save,ImageID(#Image_Save))
     ToolBarSeparator()
    ToolBarImageButtonEx(#ToolBar_Cheats_Add,ImageID(#Image_Add))
    ToolBarImageButtonEx(#ToolBar_Cheats_Remove,ImageID(#Image_Remove))
    ToolBarImageButtonEx(#ToolBar_Cheats_Edit,ImageID(#Image_Config))
     ToolBarSeparator()
    ToolBarImageButtonEx(#ToolBar_Cheats_Print,ImageID(#Image_Print))
    ToolBarImageButtonEx(#ToolBar_Cheats_Export,ImageID(#Image_Export))
    ToolBarToolTip(#ToolBar_Cheats,#ToolBar_Cheats_Save,Language(11))
    ToolBarToolTip(#ToolBar_Cheats,#ToolBar_Cheats_Add,Language(1))
    ToolBarToolTip(#ToolBar_Cheats,#ToolBar_Cheats_Remove,Language(2))
    ToolBarToolTip(#ToolBar_Cheats,#ToolBar_Cheats_Edit,Language(12))
    ToolBarToolTip(#ToolBar_Cheats,#ToolBar_Cheats_Print,Language(167))
    ToolBarToolTip(#ToolBar_Cheats,#ToolBar_Cheats_Export,Language(103))
   EndIf
   ListIconGadget(#Gadget_Cheats_List,0,ToolBarHeight(#ToolBar_Cheats),WindowWidth(#Window_MDI_Cheats),WindowHeight(#Window_MDI_Cheats)-ToolBarHeight(#ToolBar_Cheats),Language(3),200,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines|#PB_ListIcon_MultiSelect)
    AddGadgetColumn(#Gadget_Cheats_List,1,Language(4),200)
    AddGadgetColumn(#Gadget_Cheats_List,2,Language(5),200)
    AddGadgetColumn(#Gadget_Cheats_List,3,Language(6),200)
   *SortType.SortType=AllocateMemory(SizeOf(SortType))
   *SortType\Column=-1
   *SortType\Type=0
   SetGadgetData(#Gadget_Cheats_List,*SortType)
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_Teleporter,500,300,"Teleporter",#PB_Window_All,#Image_Teleporter);- Teleporter
   If CreateToolBarEx(#ToolBar_Teleporter,WindowID(#Window_MDI_Teleporter))
    ToolBarImageButtonEx(#ToolBar_Teleporter_Save,ImageID(#Image_Save))
    ToolBarImageButtonEx(#ToolBar_Teleporter_Add,ImageID(#Image_Add))
    ToolBarImageButtonEx(#ToolBar_Teleporter_Remove,ImageID(#Image_Remove))
    ToolBarImageButtonEx(#ToolBar_Teleporter_Edit,ImageID(#Image_Config))
     ToolBarSeparator()
    ToolBarImageButtonEx(#ToolBar_Teleporter_ReadMemory,ImageID(#Image_MemoryChanger))
    ToolBarImageButtonEx(#ToolBar_Teleporter_ShowMap,ImageID(#Image_ShowMap))
    ToolBarImageButtonEx(#ToolBar_Teleporter_Goto,ImageID(#Image_Teleport))
     ToolBarSeparator()
    ToolBarImageButtonEx(#ToolBar_Teleporter_Savegame,ImageID(#Image_EditSavegame))
    ToolBarToolTip(#ToolBar_Teleporter,#ToolBar_Teleporter_Save,Language(67))
    ToolBarToolTip(#ToolBar_Teleporter,#ToolBar_Teleporter_Add,Language(28))
    ToolBarToolTip(#ToolBar_Teleporter,#ToolBar_Teleporter_Remove,Language(29))
    ToolBarToolTip(#ToolBar_Teleporter,#ToolBar_Teleporter_Edit,Language(66))
    ToolBarToolTip(#ToolBar_Teleporter,#ToolBar_Teleporter_ReadMemory,Language(233))
    ToolBarToolTip(#ToolBar_Teleporter,#ToolBar_Teleporter_ShowMap,Language(30))
    ToolBarToolTip(#ToolBar_Teleporter,#ToolBar_Teleporter_Goto,Language(71))
    ToolBarToolTip(#ToolBar_Teleporter,#ToolBar_Teleporter_Savegame,Language(57))
   EndIf
   ContainerGadget(#Gadget_Teleporter_EditContainer,0,ToolBarHeight(#ToolBar_Teleporter),WindowWidth(#Window_MDI_Teleporter),160,#PB_Container_Flat)
    TextGadget(#Gadget_Teleporter_Text1,10,10,40,20,"Cheat:")
    TextGadget(#Gadget_Teleporter_Text2,10,40,40,20,"X:")
    TextGadget(#Gadget_Teleporter_Text3,10,70,40,20,"Y:")
    TextGadget(#Gadget_Teleporter_Text4,10,100,40,20,"Z:")
    TextGadget(#Gadget_Teleporter_Text5,10,130,40,20,"Interior:")
    StringGadget(#Gadget_Teleporter_EditCheat,60,10,GadgetWidth(#Gadget_Teleporter_EditContainer)-70,20,"",#PB_String_UpperCase)
    StringGadget(#Gadget_Teleporter_EditX,60,40,GadgetWidth(#Gadget_Teleporter_EditCheat),20,"")
    StringGadget(#Gadget_Teleporter_EditY,60,70,GadgetWidth(#Gadget_Teleporter_EditCheat),20,"")
    StringGadget(#Gadget_Teleporter_EditZ,60,100,GadgetWidth(#Gadget_Teleporter_EditCheat),20,"")
    ComboBoxGadget(#Gadget_Teleporter_EditInterior,60,130,GadgetWidth(#Gadget_Teleporter_EditCheat),20)
   CloseGadgetList()
   ListIconGadget(#Gadget_Teleporter_List,0,ToolBarHeight(#ToolBar_Teleporter)+GadgetHeight(#Gadget_Teleporter_EditContainer),WindowWidth(#Window_MDI_Teleporter),WindowHeight(#Window_MDI_Teleporter)-GadgetHeight(#Gadget_Teleporter_EditContainer)-ToolBarHeight(#ToolBar_Teleporter),"Cheat",200,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines|#PB_ListIcon_MultiSelect)
    AddGadgetColumn(#Gadget_Teleporter_List,1,"X",50)
    AddGadgetColumn(#Gadget_Teleporter_List,2,"Y",50)
    AddGadgetColumn(#Gadget_Teleporter_List,3,"Z",50)
    AddGadgetColumn(#Gadget_Teleporter_List,4,"Interior",100)
   AddGadgetItem(#Gadget_Teleporter_EditInterior,-1,Language(170))
   SetGadgetState(#Gadget_Teleporter_EditInterior,0)
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_SavegameManager,500,300,"SavegameManager",#PB_Window_All,#Image_SavegameManager)
   If CreateToolBarEx(#ToolBar_SavegameManager,WindowID(#Window_MDI_SavegameManager))
    ToolBarImageButtonEx(#ToolBar_SavegameManager_Save,ImageID(#Image_Save))
    ToolBarImageButtonEx(#ToolBar_SavegameManager_Edit,ImageID(#Image_Config))
    ToolBarImageButtonEx(#ToolBar_SavegameManager_CreateBackup,ImageID(#Image_CreateBackup))
    ToolBarImageButtonEx(#ToolBar_SavegameManager_RestoreBackup,ImageID(#Image_RestoreBackup))
    ToolBarImageButtonEx(#ToolBar_SavegameManager_Refresh,ImageID(#Image_Refresh))
    ToolBarToolTip(#ToolBar_SavegameManager,#ToolBar_SavegameManager_Save,Language(238))
    ToolBarToolTip(#ToolBar_SavegameManager,#ToolBar_SavegameManager_Edit,Language(21))
    ToolBarToolTip(#ToolBar_SavegameManager,#ToolBar_SavegameManager_CreateBackup,Language(22))
    ToolBarToolTip(#ToolBar_SavegameManager,#ToolBar_SavegameManager_RestoreBackup,Language(23))
    ToolBarToolTip(#ToolBar_SavegameManager,#ToolBar_SavegameManager_Refresh,Language(27))
   EndIf
   ListIconGadget(#Gadget_SavegameManager_List,0,ToolBarHeight(#ToolBar_SavegameManager),WindowWidth(#Window_MDI_SavegameManager),WindowHeight(#Window_MDI_SavegameManager)-ToolBarHeight(#ToolBar_SavegameManager),Language(7),200,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines)
    AddGadgetColumn(#Gadget_SavegameManager_List,1,Language(18),200)
    AddGadgetColumn(#Gadget_SavegameManager_List,2,Language(169),50)
    AddGadgetColumn(#Gadget_SavegameManager_List,3,Language(171),50)
   ScrollAreaGadget(#Gadget_SavegameManager_EditArea,0,ToolBarHeight(#ToolBar_SavegameManager),WindowWidth(#Window_MDI_SavegameManager),WindowHeight(#Window_MDI_SavegameManager)-ToolBarHeight(#ToolBar_SavegameManager),500,500,10,#PB_ScrollArea_Flat)
    TextGadget(#Gadget_SavegameManager_Editor_Text1,10,10,110,20,"Name:")
    TextGadget(#Gadget_SavegameManager_Editor_Text2,10,40,110,20,Language(157))
    TextGadget(#Gadget_SavegameManager_Editor_Text3,10,70,110,20,Language(158))
    TextGadget(#Gadget_SavegameManager_Editor_Text4,10,100,110,20,Language(159))
    TextGadget(#Gadget_SavegameManager_Editor_Text5,10,130,110,20,Language(160))
    StringGadget(#Gadget_SavegameManager_Editor_Name,130,10,150,20,"")
    StringGadget(#Gadget_SavegameManager_Editor_Money,130,40,150,20,"",#PB_String_Numeric)
    StringGadget(#Gadget_SavegameManager_Editor_MaxHealth,130,70,150,20,"",#PB_String_Numeric)
    StringGadget(#Gadget_SavegameManager_Editor_MaxArmor,130,100,150,20,"",#PB_String_Numeric)
    SpinGadget(#Gadget_SavegameManager_Editor_Clock,130,130,150,20,0,1441,#PB_Spin_ReadOnly)
   CloseGadgetList()
   DisableToolBarButton(#ToolBar_SavegameManager,#ToolBar_SavegameManager_Save,1)
   HideGadget(#Gadget_SavegameManager_EditArea,1)
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_Models,500,300,Language(68),#PB_Window_All,#Image_Models)
   If CreateToolBarEx(#ToolBar_Models,WindowID(#Window_MDI_Models))
    ToolBarImageButtonEx(#ToolBar_Models_Save,ImageID(#Image_Save))
    ToolBarImageButtonEx(#ToolBar_Models_Edit,ImageID(#Image_Config)):DisableToolBarButton(#ToolBar_Models,#ToolBar_Models_Edit,1)
    ToolBarImageButtonEx(#ToolBar_Models_AddAsCheat,ImageID(#Image_Add))
    ToolBarImageButtonEx(#ToolBar_Models_Spawn,ImageID(#Image_Spawn))
    ToolBarImageButtonEx(#ToolBar_Models_Refresh,ImageID(#Image_Refresh))
    ToolBarToolTip(#ToolBar_Models,#ToolBar_Models_Save,Language(90))
    ToolBarToolTip(#ToolBar_Models,#ToolBar_Models_Edit,Language(92))
    ToolBarToolTip(#ToolBar_Models,#ToolBar_Models_AddAsCheat,Language(96))
    ToolBarToolTip(#ToolBar_Models,#ToolBar_Models_Spawn,Language(94))
    ToolBarToolTip(#ToolBar_Models,#ToolBar_Models_Refresh,Language(27))
   EndIf
   PanelGadget(#Gadget_Models_Panel,0,ToolBarHeight(#ToolBar_Models),WindowWidth(#Window_MDI_Models),WindowHeight(#Window_MDI_Models)-ToolBarHeight(#ToolBar_Models))
    AddGadgetItem(#Gadget_Models_Panel,-1,Language(69))
     ListIconGadget(#Gadget_Models_VehicleList,10,10,GadgetWidth(#Gadget_Models_Panel)-440,GadgetHeight(#Gadget_Models_Panel)-45,Language(73),100,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines|#PB_ListIcon_CheckBoxes)
      AddGadgetColumn(#Gadget_Models_VehicleList,1,"Name",200)
      AddGadgetColumn(#Gadget_Models_VehicleList,2,Language(99),200)
      AddGadgetColumn(#Gadget_Models_VehicleList,3,"Radio",100)
    AddGadgetItem(#Gadget_Models_Panel,-1,Language(70))
     ListIconGadget(#Gadget_Models_WeaponList,10,10,GadgetWidth(#Gadget_Models_Panel)-340,GadgetHeight(#Gadget_Models_Panel)-45,Language(74),100,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines)
      AddGadgetColumn(#Gadget_Models_WeaponList,1,"Name",200)
      AddGadgetColumn(#Gadget_Models_WeaponList,2,"ID", 100)
      AddGadgetColumn(#Gadget_Models_WeaponList,3,Language(87),100)
      AddGadgetColumn(#Gadget_Models_WeaponList,4,Language(88),150)
      AddGadgetColumn(#Gadget_Models_WeaponList,5,Language(89),150)
    CloseGadgetList()
   ContainerGadget(#Gadget_Models_ImageContainer,0,0,0,0)
    ImageGadget(#Gadget_Models_Image,GadgetWidth(#Gadget_Models_WeaponList)+20,10,300,300,0,#PB_Image_Border)
   CloseGadgetList()
   SplitterGadget(#Gadget_Models_Splitter,0,0,WindowWidth(#Window_MDI_Models),WindowHeight(#Window_MDI_Models)-ToolBarHeight(#ToolBar_Models),#Gadget_Models_Panel,#Gadget_Models_ImageContainer,#PB_Splitter_Separator|#PB_Splitter_Vertical)
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_MemoryChanger,500,300,"MemoryChanger",#PB_Window_All,#Image_MemoryChanger)
   If CreateToolBarEx(#ToolBar_MemoryChanger,WindowID(#Window_MDI_MemoryChanger))
    ToolBarImageButton(#ToolBar_MemoryChanger_Save,ImageID(#Image_Save))
    ToolBarImageButton(#ToolBar_MemoryChanger_Add,ImageID(#Image_Add))
    ToolBarImageButton(#ToolBar_MemoryChanger_Set,ImageID(#Image_Set))
    ToolBarImageButton(#ToolBar_MemoryChanger_Remove,ImageID(#Image_Remove))
     ToolBarSeparator()
    ToolBarImageButton(#ToolBar_MemoryChanger_ReadMemory,ImageID(#Image_Refresh))
    ToolBarImageButton(#ToolBar_MemoryChanger_WriteMemory,ImageID(#Image_Set))
     ToolBarSeparator()
    ToolBarImageButtonEx(#ToolBar_MemoryChanger_ConnectTo,ImageID(#Image_Server))
    ToolBarToolTip(#ToolBar_MemoryChanger,#ToolBar_MemoryChanger_Add,Language(48))
    ToolBarToolTip(#ToolBar_MemoryChanger,#ToolBar_MemoryChanger_Set,Language(134))
    ToolBarToolTip(#ToolBar_MemoryChanger,#ToolBar_MemoryChanger_Remove,"Remove")
    ToolBarToolTip(#ToolBar_MemoryChanger,#ToolBar_MemoryChanger_Clear,"Clear")
    ToolBarToolTip(#ToolBar_MemoryChanger,#ToolBar_MemoryChanger_ReadMemory,Language(135))
    ToolBarToolTip(#ToolBar_MemoryChanger,#ToolBar_MemoryChanger_WriteMemory,Language(136))
   EndIf
   ContainerGadget(#Gadget_MemoryChanger_EditContainer,0,ToolBarHeight(#ToolBar_MemoryChanger),WindowWidth(#Window_MDI_MemoryChanger),100,#PB_Container_Flat)
    TextGadget(#Gadget_MemoryChanger_Text1,10,10,50,20,"Name:")
    TextGadget(#Gadget_MemoryChanger_Text2,10,40,50,20,Language(137)+":")
    TextGadget(#Gadget_MemoryChanger_Text3,10,70,50,20,Language(138)+":")
    TextGadget(#Gadget_MemoryChanger_Text4,10,100,50,20,Language(139)+":")
    StringGadget(#Gadget_MemoryChanger_Name,70,10,GadgetWidth(#Gadget_MemoryChanger_EditContainer)-80,20,"")
    StringGadget(#Gadget_MemoryChanger_Address,70,40,GadgetWidth(#Gadget_MemoryChanger_EditContainer)-80,20,"",#PB_String_UpperCase)
    ComboBoxGadget(#Gadget_MemoryChanger_DataType,70,70,GadgetWidth(#Gadget_MemoryChanger_EditContainer)-80,20)
    StringGadget(#Gadget_MemoryChanger_Value,70,100,GadgetWidth(#Gadget_MemoryChanger_EditContainer)-80,20,"")
   CloseGadgetList()
   ListIconGadget(#Gadget_MemoryChanger_List,0,GadgetHeight(#Gadget_MemoryChanger_EditContainer)+ToolBarHeight(#ToolBar_MemoryChanger),WindowWidth(#Window_MDI_MemoryChanger),WindowHeight(#Window_MDI_MemoryChanger)-GadgetHeight(#Gadget_MemoryChanger_EditContainer)-ToolBarHeight(#ToolBar_MemoryChanger),"Name",200,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines)
    AddGadgetColumn(#Gadget_MemoryChanger_List,1,Language(137),100)
    AddGadgetColumn(#Gadget_MemoryChanger_List,2,Language(138),200)
    AddGadgetColumn(#Gadget_MemoryChanger_List,3,Language(139),200)
   SetGadgetState(#Gadget_MemoryChanger_DataType,0)
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_IMGEditor,500,300,"IMG Editor",#PB_Window_All,#Image_IMGEditor);- IMG Editor
   If CreateToolBarEx(#ToolBar_IMGEditor,WindowID(#Window_MDI_IMGEditor))
    ToolBarImageButtonEx(#ToolBar_IMGEditor_Open,ImageID(#Image_Open))
    ToolBarImageButtonEx(#ToolBar_IMGEditor_Export,ImageID(#Image_Export))
    ToolBarImageButtonEx(#ToolBar_IMGEditor_Replace,ImageID(#Image_Replace))
    ToolBarImageButtonEx(#ToolBar_IMGEditor_Delete,ImageID(#Image_Remove))
    ToolBarImageButtonEx(#ToolBar_IMGEditor_Insert,ImageID(#Image_Insert))
    ToolBarToolTip(#ToolBar_IMGEditor,#ToolBar_IMGEditor_Open,Language(25))
    ToolBarToolTip(#ToolBar_IMGEditor,#ToolBar_IMGEditor_Export,Language(103))
    ToolBarToolTip(#ToolBar_IMGEditor,#ToolBar_IMGEditor_Replace,Language(104))
    ToolBarToolTip(#ToolBar_IMGEditor,#ToolBar_IMGEditor_Delete,Language(105))
    ToolBarToolTip(#ToolBar_IMGEditor,#ToolBar_IMGEditor_Insert,Language(51))
   EndIf
   ListIconGadget(#Gadget_IMGEditor_List,0,ToolBarHeight(#ToolBar_IMGEditor),WindowWidth(#Window_MDI_IMGEditor),WindowHeight(#Window_MDI_IMGEditor)-ToolBarHeight(#ToolBar_IMGEditor)-20,"Name",150,#PB_ListIcon_FullRowSelect|#PB_ListIcon_MultiSelect)
    AddGadgetColumn(#Gadget_IMGEditor_List,1,"Offset",150)
    AddGadgetColumn(#Gadget_IMGEditor_List,2,Language(98),150)
    AddGadgetColumn(#Gadget_IMGEditor_List,3,Language(99),150)
   ProgressBarGadget(#Gadget_IMGEditor_Progress,0,WindowHeight(#Window_MDI_IMGEditor)-20,WindowWidth(#Window_MDI_IMGEditor),20,0,0,#PB_ProgressBar_Smooth)
   *SortType.SortType=AllocateMemory(SizeOf(SortType))
   *SortType\Column=-1
   *SortType\Type=0
   SetGadgetData(#Gadget_IMGEditor_List,*SortType)
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_CleoManager,500,300,"CleoManager",#PB_Window_All,#Image_CleoManager);- CleoManager
   If CreateToolBarEx(#ToolBar_CleoManager,WindowID(#Window_MDI_CleoManager))
   EndIf
   ListIconGadget(#Gadget_CleoManager_List,0,ToolBarHeight(#ToolBar_CleoManager),WindowWidth(#Window_MDI_CleoManager),WindowHeight(#Window_MDI_CleoManager)-ToolBarHeight(#ToolBar_CleoManager),"Name",200,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines)
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_IPLEditor,500,300,"IPL Editor",#PB_Window_All,#Image_IPLEditor)
   ComboBoxGadget(#Gadget_IPLEditor_Files,0,0,200,20)
   ButtonGadget(#Gadget_IPLEditor_Save,WindowWidth(#Window_MDI_IPLEditor)-150,0,150,20,Language(179))
   ListIconGadget(#Gadget_IPLEditor_List,0,20,WindowWidth(#Window_MDI_IPLEditor),WindowHeight(#Window_MDI_IPLEditor)-20,"ID",100,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines|#PB_ListIcon_MultiSelect)
    AddGadgetColumn(#Gadget_IPLEditor_List,1,"Model",200)
    AddGadgetColumn(#Gadget_IPLEditor_List,2,"Interior",50)
    AddGadgetColumn(#Gadget_IPLEditor_List,3,"X",100)
    AddGadgetColumn(#Gadget_IPLEditor_List,4,"Y",100)
    AddGadgetColumn(#Gadget_IPLEditor_List,5,"Z",100)
    AddGadgetColumn(#Gadget_IPLEditor_List,6,"Unknown 1",100)
    AddGadgetColumn(#Gadget_IPLEditor_List,7,"Unknown 2",100)
    AddGadgetColumn(#Gadget_IPLEditor_List,8,"Unknown 3",100)
    AddGadgetColumn(#Gadget_IPLEditor_List,9,"Unknown 4",100)
    AddGadgetColumn(#Gadget_IPLEditor_List,10,"LOD",100)
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_GameTweaks,500,300,"GameTweaks",#PB_Window_All,#Image_GameTweaks)
   If CreateToolBarEx(#ToolBar_GameTweaks,WindowID(#Window_MDI_GameTweaks))
    ToolBarImageButtonEx(#ToolBar_GameTweaks_Read,ImageID(#Image_Refresh))
    ToolBarImageButtonEx(#ToolBar_GameTweaks_Write,ImageID(#Image_Set))
    ToolBarToolTip(#ToolBar_GameTweaks,#ToolBar_GameTweaks_Read,Language(121))
    ToolBarToolTip(#ToolBar_GameTweaks,#ToolBar_GameTweaks_Write,Language(122))
   EndIf
   PanelGadget(#Gadget_GameTweaks_Panel,0,ToolBarHeight(#ToolBar_GameTweaks),WindowWidth(#Window_MDI_GameTweaks),WindowHeight(#Window_MDI_GameTweaks)-ToolBarHeight(#ToolBar_GameTweaks))
    AddGadgetItem(#Gadget_GameTweaks_Panel,-1,Language(123))
     ScrollAreaGadget(#Gadget_GameTweaks_StatisticScroll,0,0,GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemWidth),GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemHeight),GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemWidth),490,30,#PB_ScrollArea_Center|#PB_ScrollArea_Flat)
      TextGadget(#Gadget_GameTweaks_Text1,10,10,150,20,Language(207))
      TextGadget(#Gadget_GameTweaks_Text2,10,40,150,20,Language(208))
      TextGadget(#Gadget_GameTweaks_Text3,10,70,150,20,"Desert Eagle")
      TextGadget(#Gadget_GameTweaks_Text4,10,100,150,20,Language(209))
      TextGadget(#Gadget_GameTweaks_Text5,10,130,150,20,Language(210))
      TextGadget(#Gadget_GameTweaks_Text6,10,160,150,20,Language(211))
      TextGadget(#Gadget_GameTweaks_Text7,10,190,150,20,Language(212))
      TextGadget(#Gadget_GameTweaks_Text8,10,220,150,20,"SMG")
      TextGadget(#Gadget_GameTweaks_Text9,10,250,150,20,"AK47")
      TextGadget(#Gadget_GameTweaks_Text10,10,280,150,20,"M4")
      TextGadget(#Gadget_GameTweaks_Text11,10,340,150,20,Language(213))
      TextGadget(#Gadget_GameTweaks_Text12,10,370,150,20,Language(214))
      TextGadget(#Gadget_GameTweaks_Text13,10,400,150,20,Language(215))
      TextGadget(#Gadget_GameTweaks_Text14,10,430,150,20,Language(216))
      TextGadget(#Gadget_GameTweaks_Text15,10,460,150,20,Language(217))
      TrackBarGadget(#Gadget_GameTweaks_PistolState,170,10,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_SilencedPistolState,170,50,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_DesertEagleState,170,80,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_ShotgunState,170,110,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_SawnoffShotgunState,170,140,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_CombatShotgunState,170,170,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_MachinePistolState,170,200,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_SMGState,170,230,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_AK47State,170,260,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_M4State,170,290,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_FatState,170,340,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_StaminaState,170,370,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_MuscleState,170,400,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_HealthState,170,430,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
      TrackBarGadget(#Gadget_GameTweaks_SexAppealState,170,460,GadgetWidth(#Gadget_GameTweaks_Panel)-180,20,0,1000)
     CloseGadgetList()
    AddGadgetItem(#Gadget_GameTweaks_Panel,-1,Language(173))
     ScrollAreaGadget(#Gadget_GameTweaks_GirlfriendsScroll,0,0,GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemWidth),GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemHeight),GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemWidth),190,30,#PB_ScrollArea_Center|#PB_ScrollArea_Flat)
      TextGadget(#Gadget_GameTweaks_Text16,10,10,100,20,"Denise")
      TextGadget(#Gadget_GameTweaks_Text17,10,40,100,20,"Michelle")
      TextGadget(#Gadget_GameTweaks_Text18,10,70,100,20,"Helena")
      TextGadget(#Gadget_GameTweaks_Text19,10,100,100,20,"Barbara")
      TextGadget(#Gadget_GameTweaks_Text20,10,130,100,20,"Katie")
      TextGadget(#Gadget_GameTweaks_Text21,10,160,100,20,"Millie")
      TrackBarGadget(#Gadget_GameTweaks_DeniseState,120,10,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20,0,100)
      TrackBarGadget(#Gadget_GameTweaks_MichelleState,120,40,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20,0,100)
      TrackBarGadget(#Gadget_GameTweaks_HelenaState,120,70,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20,0,100)
      TrackBarGadget(#Gadget_GameTweaks_BarbaraState,120,100,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20,0,100)
      TrackBarGadget(#Gadget_GameTweaks_KatieState,120,130,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20,0,100)
      TrackBarGadget(#Gadget_GameTweaks_MillieState,120,160,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20,0,100)
     CloseGadgetList()
    CloseGadgetList()
  EndIf
  If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_Config,500,300,Language(24),#PB_Window_All,#Image_Config)
   If CreateToolBarEx(#ToolBar_Config,WindowID(#Window_MDI_Config))
    ToolBarImageButtonEx(#ToolBar_Config_Save,ImageID(#Image_Save))
    ToolBarToolTip(#ToolBar_Config,#ToolBar_Config_Save,Language(35))
   EndIf
   ScrollAreaGadget(#Gadget_Config_ScrollArea,0,ToolBarHeight(#ToolBar_Config),WindowWidth(#Window_MDI_Config),WindowHeight(#Window_MDI_Config)-ToolBarHeight(#ToolBar_Config),1045,540,10,#PB_ScrollArea_Flat|#PB_ScrollArea_Center)
    Frame3DGadget(#Gadget_Config_FrameGeneral,10,10,580,90,Language(44))
     CheckBoxGadget(#Gadget_Config_RememberMDI,20,30,160,20,Language(39))
     CheckBoxGadget(#Gadget_Config_MinimizeToTray,190,30,140,20,Language(38))
     CheckBoxGadget(#Gadget_Config_StartMinimized,360,30,100,20,Language(37))
     CheckBoxGadget(#Gadget_Config_UseTabs,470,30,100,20,Language(72))
     CheckBoxGadget(#Gadget_Config_DisplayMessages,20,50,125,20,Language(36))
     CheckBoxGadget(#Gadget_Config_QuitConfirm,190,50,150,20,Language(58))
     CheckBoxGadget(#Gadget_Config_AutoCheckUpdates,360,50,190,20,Language(117))
     CheckBoxGadget(#Gadget_Config_DisableGTASplash,20,70,150,20,Language(148))
     CheckBoxGadget(#Gadget_Config_CloseModulesOnQuit,190,70,160,20,Language(178))
     CheckBoxGadget(#Gadget_Config_AutoSaveData,360,70,190,20,Language(254))
    Frame3DGadget(#Gadget_Config_FrameCheatSound,10,110,580,50,"Cheatsound")
     CheckBoxGadget(#Gadget_Config_UseCheatSound,20,130,80,20,Language(40))
     StringGadget(#Gadget_Config_CheatSound,110,130,360,20,"",#PB_String_ReadOnly)
     ButtonGadget(#Gadget_Config_OpenCheatSound,480,130,100,20,Language(25))
    Frame3DGadget(#Gadget_Config_FrameBackground,10,170,580,50,Language(166))
     CheckBoxGadget(#Gadget_Config_UseBackground,20,190,80,20,Language(40))
     StringGadget(#Gadget_Config_Background,110,190,360,20,"",#PB_String_ReadOnly)
     ButtonGadget(#Gadget_Config_OpenBackground,480,190,100,20,Language(25))
    Frame3DGadget(#Gadget_Config_GTA,10,230,580,50,"GTA San Andreas")
     StringGadget(#Gadget_Config_GTAFile,20,250,450,20,"",#PB_String_ReadOnly)
     ButtonGadget(#Gadget_Config_OpenGTAFile,480,250,100,20,Language(25))
    Frame3DGadget(#Gadget_Config_FrameLanguage,810,10,155,50,Language(41))
     ComboBoxGadget(#Gadget_Config_Language,820,30,135,20)
      AddGadgetItem(#Gadget_Config_Language,-1,Language(42))
      AddGadgetItem(#Gadget_Config_Language,-1,Language(43))
    Frame3DGadget(#Gadget_Config_FrameServer,810,70,155,50,"Server")
     TextGadget(#Gadget_Config_Text1,820,90,25,20,"Port:")
     StringGadget(#Gadget_Config_ServerPort,855,90,100,20,"",#PB_String_Numeric)
    Frame3DGadget(#Gadget_Config_FrameCheatProcessor,10,290,415,235,Language(47))
     ListViewGadget(#Gadget_Config_CheatProcessorList,20,310,285,200)
     ButtonGadget(#Gadget_Config_CheatProcessorAdd,315,310,100,20,Language(48))
     ButtonGadget(#Gadget_Config_CheatProcessorRemove,315,340,100,20,Language(49))
     ButtonGadget(#Gadget_Config_CheatProcessorClear,315,370,100,20,Language(50))
    Frame3DGadget(#Gadget_Config_FrameImageType,600,10,200,90,Language(114))
     OptionGadget(#Gadget_Config_ImageTypeBMP,610,30,180,20,"Windows Bitmap (bmp)")
     OptionGadget(#Gadget_Config_ImageTypeJPG,610,50,180,20,"Jpeg (jpg)")
     OptionGadget(#Gadget_Config_ImageTypePNG,610,70,180,20,"Portable Network Graphics (png)")
    Frame3DGadget(#Gadget_Config_FrameMapType,600,110,200,70,Language(244))
     OptionGadget(#Gadget_Config_MapType2D,610,130,110,20,Language(245))
     OptionGadget(#Gadget_Config_MapType3D,610,150,110,20,Language(246))
    Frame3DGadget(#Gadget_Config_FrameFileTypes,435,290,395,235,Language(115))
     ListIconGadget(#Gadget_Config_FileTypesList,445,310,375,200,Language(116),100,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines)
      AddGadgetColumn(#Gadget_Config_FileTypesList,1,"Name",150)
    Frame3DGadget(#Gadget_Config_FrameStartup,600,210,230,70,Language(142))
     CheckBoxGadget(#Gadget_Config_StartupCheatProcessor,610,230,100,20,"CheatProcessor")
     CheckBoxGadget(#Gadget_Config_StartupMemoryServer,720,230,100,20,"MemoryServer")
     CheckBoxGadget(#Gadget_Config_StartupWebServer,610,250,100,20,"WebServer")
   CloseGadgetList()
   If OpenMDIWindow(#Gadget_Main_MDI,#Window_MDI_Tools,500,300,Language(109),#PB_Window_All,#Image_Tools)
    If CreateToolBarEx(#ToolBar_Tools,WindowID(#Window_MDI_Tools))
     ToolBarImageButtonEx(#ToolBar_Tools_Add,ImageID(#Image_Add))
     ToolBarImageButtonEx(#ToolBar_Tools_Remove,ImageID(#Image_Remove))
     ToolBarImageButtonEx(#ToolBar_Tools_Edit,ImageID(#Image_Config))
      ToolBarSeparator()
     ToolBarImageButtonEx(#ToolBar_Tools_AddBar,ImageID(#Image_MenuBar))
     ToolBarImageButtonEx(#ToolBar_Tools_OpenSubMenu,ImageID(#Image_OpenSubMenu))
     ToolBarImageButtonEx(#ToolBar_Tools_CloseSubMenu,ImageID(#Image_CloseSubMenu))
      ToolBarSeparator()
     ToolBarImageButtonEx(#ToolBar_Tools_MoveUp,ImageID(#Image_Up))
     ToolBarImageButtonEx(#ToolBar_Tools_MoveDown,ImageID(#Image_Down))
      ToolBarSeparator()
     ToolBarImageButtonEx(#ToolBar_Tools_RefreshMenu,ImageID(#Image_Refresh))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_Add,Language(111))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_Remove,Language(112))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_Edit,Language(113))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_AddBar,Language(118))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_OpenSubMenu,Language(203))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_CloseSubMenu,Language(204))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_MoveUp,Language(149))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_MoveDown,Language(150))
     ToolBarToolTip(#ToolBar_Tools,#ToolBar_Tools_RefreshMenu,Language(151))
    EndIf
    ListIconGadget(#Gadget_Tools_List,0,ToolBarHeight(#ToolBar_Tools),WindowWidth(#Window_MDI_Tools),WindowHeight(#Window_MDI_Tools)-ToolBarHeight(#ToolBar_Tools),"Name",150,#PB_ListIcon_FullRowSelect|#PB_ListIcon_GridLines)
     AddGadgetColumn(#Gadget_Tools_List,1,Language(7),150)
     AddGadgetColumn(#Gadget_Tools_List,2,"Parameter",100)
    EnableGadgetDrop(#Gadget_Tools_List,#PB_Drop_Files,#PB_Drag_Copy)
    HideWindow(#Window_MDI_Tools,1)
   EndIf
   For Gadget=#Gadget_Config_ScrollArea To #Gadget_Config_FileTypesList
    SetGadgetFont(Gadget,FontID(#Font_Default))
   Next
  EndIf
 If AddSysTrayIcon(#Tray,WindowID(#Window_Main),ImageID(#Image_Tray))
  SysTrayIconToolTip(#Tray,"GTA San Andreas ToolBox")
 EndIf
 For Interior=0 To 18
  AddGadgetItem(#Gadget_Teleporter_EditInterior,Interior+1,Interior(Interior))
 Next
 For VehicleID=400 To 611
  AddGadgetItem(#Gadget_Models_VehicleList,-1,Str(VehicleID))
  *Vehicles.Vehicles
  *Vehicles=AllocateMemory(SizeOf(Vehicles))
  *Vehicles\ID=VehicleID
  SetGadgetItemData(#Gadget_Models_VehicleList,CountGadgetItems(#Gadget_Models_VehicleList)-1,*Vehicles)
 Next
 ImageListID=ListIcon_CreateImageList(#Gadget_Cheats_List,16,16)
 Config\Cheats_HeaderImage\Empty=ListIcon_AddImage(ImageListID,#Image_Empty)
 Config\Cheats_HeaderImage\ArrowUp=ListIcon_AddImage(ImageListID,#Image_ArrowUp)
 Config\Cheats_HeaderImage\ArrowDown=ListIcon_AddImage(ImageListID,#Image_ArrowDown)
 LoadSettings(0)
 SaveSettings()
 LoadMap()
 LoadBackground()
 SmartWindowRefresh(#Window_Main,Config\SmartWindowRefresh)
 RefreshWindowMenu()
 SetWindowCallback(@WindowCallback())
 ReloadSavegames()
 ReloadMemoryChangerList()
 Config\LoadGadgetData=CreateThread(@LoadGadgetData(),0)
 ResizeGadget(#Gadget_Models_VehicleList,0,0,GetGadgetAttribute(#Gadget_Models_Panel,#PB_Panel_ItemWidth),GetGadgetAttribute(#Gadget_Models_Panel,#PB_Panel_ItemHeight))
 ResizeGadget(#Gadget_Models_WeaponList,0,0,GetGadgetAttribute(#Gadget_Models_Panel,#PB_Panel_ItemWidth),GetGadgetAttribute(#Gadget_Models_Panel,#PB_Panel_ItemHeight))
 ResizeGadget(#Gadget_Models_Image,0,0,GadgetWidth(#Gadget_Models_ImageContainer),GadgetHeight(#Gadget_Models_ImageContainer))
 If Config\Startup_CheatProcessor
  If IsModuleRunning(#Module_CheatProcessor)
   SendMessage(#Module_CheatProcessor,#Module_CMD_ReloadAll)
  Else
   RunProgram(Common\InstallPath+"CheatProcessor.exe","",Common\InstallPath)
  EndIf
 EndIf
 If Config\Startup_MemoryServer
  If IsModuleRunning(#Module_MemoryServer)=0
   RunProgram(Common\InstallPath+"MemoryServer.exe","",Common\InstallPath)
  EndIf
 EndIf
 If Config\Startup_WebServer
  If IsModuleRunning(#Module_WebServer)
   SendMessage(#Module_WebServer,#Module_CMD_ReloadAll)
  Else
   RunProgram(Common\InstallPath+"WebServer.exe","",Common\InstallPath)
  EndIf
 EndIf
 DisableWindow(#Window_Main,1)
 Repeat
  If Started=0
   If IsThread(Config\LoadGadgetData)=0
    DisableWindow(#Window_Main,0)
    If Config\StartMinimized=0 And IsParameter("/min")=0
     SetWindowState(#Window_Main,Windows\Main\State)
     RestoreWindow()
    EndIf
    If IsWindow(#Window_Splash)
     CloseWindow(#Window_Splash)
    EndIf
    File=CreateFile(#PB_Any,Common\InstallPath+"Start.log")
     If IsFile(File)
      WriteStringN(File,"Last start:  "+FormatDate("%dd.%mm.%yyyy %hh:%ii:%ss",Date()))
      WriteString(File,"Start length: "+Str(ElapsedMilliseconds()-Config\StartTime)+"ms")
      CloseFile(File)
     EndIf
    Started=1
   EndIf
  EndIf
  Title$=GetWindowTitle(#Window_RunOnlyOnceCheckWindow)
  Title$=Trim(Right(Title$,Len(Title$)-Len(#RunOnlyOnceTitle_GUI)))
   If Title$
    Select Title$
     Case #Module_CMD_Restore
      RestoreWindow()
     Case #Module_CMD_RunGTA
      RunGTA()
    EndSelect
    SetWindowTitle(#Window_RunOnlyOnceCheckWindow,#RunOnlyOnceTitle_GUI)
   EndIf
  Select GetWindowState(#Window_Main)
   Case #PB_Window_Minimize
    HideWindow(#Window_Main,Config\MinimizeToTray)
   Default
    Windows\Main\State=GetWindowState(#Window_Main)
    Windows\Cheats\State=GetWindowState(#Window_MDI_Cheats)
    Windows\Teleporter\State=GetWindowState(#Window_MDI_Teleporter)
    Windows\SavegameManager\State=GetWindowState(#Window_MDI_SavegameManager)
    Windows\Models\State=GetWindowState(#Window_MDI_Models)
    Windows\MemoryChanger\State=GetWindowState(#Window_MDI_MemoryChanger)
    Windows\IMGEditor\State=GetWindowState(#Window_MDI_IMGEditor)
    Windows\CleoManager\State=GetWindowState(#Window_MDI_CleoManager)
    Windows\IPLEditor\State=GetWindowState(#Window_MDI_IPLEditor)
    Windows\GameTweaks\State=GetWindowState(#Window_MDI_GameTweaks)
    Windows\Config\State=GetWindowState(#Window_MDI_Config)
    Windows\Cheats\Show=IsWindowVisible_(WindowID(#Window_MDI_Cheats))
    Windows\Teleporter\Show=IsWindowVisible_(WindowID(#Window_MDI_Teleporter))
    Windows\SavegameManager\Show=IsWindowVisible_(WindowID(#Window_MDI_SavegameManager))
    Windows\Models\Show=IsWindowVisible_(WindowID(#Window_MDI_Models))
    Windows\MemoryChanger\Show=IsWindowVisible_(WindowID(#Window_MDI_MemoryChanger))
    Windows\IMGEditor\Show=IsWindowVisible_(WindowID(#Window_MDI_IMGEditor))
    Windows\CleoManager\Show=IsWindowVisible_(WindowID(#Window_MDI_CleoManager))
    Windows\IPLEditor\Show=IsWindowVisible_(WindowID(#Window_MDI_IPLEditor))
    Windows\GameTweaks\Show=IsWindowVisible_(WindowID(#Window_MDI_GameTweaks))
    Windows\Config\Show=IsWindowVisible_(WindowID(#Window_MDI_Config))
    If Windows\Main\State=#PB_Window_Normal
     Windows\Main\x=WindowX(#Window_Main)
     Windows\Main\y=WindowY(#Window_Main)
     Windows\Main\Width=WindowWidth(#Window_Main)
     Windows\Main\Height=WindowHeight(#Window_Main)
    EndIf
    If Windows\Cheats\State=#PB_Window_Normal
     Windows\Cheats\x=WindowX(#Window_MDI_Cheats)
     Windows\Cheats\y=WindowY(#Window_MDI_Cheats)
     Windows\Cheats\Width=WindowWidth(#Window_MDI_Cheats)
     Windows\Cheats\Height=WindowHeight(#Window_MDI_Cheats)
    EndIf
    If Windows\Teleporter\State=#PB_Window_Normal
     Windows\Teleporter\x=WindowX(#Window_MDI_Teleporter)
     Windows\Teleporter\y=WindowY(#Window_MDI_Teleporter)
     Windows\Teleporter\Width=WindowWidth(#Window_MDI_Teleporter)
     Windows\Teleporter\Height=WindowHeight(#Window_MDI_Teleporter)
    EndIf
    If Windows\SavegameManager\State=#PB_Window_Normal
     Windows\SavegameManager\x=WindowX(#Window_MDI_SavegameManager)
     Windows\SavegameManager\y=WindowY(#Window_MDI_SavegameManager)
     Windows\SavegameManager\Width=WindowWidth(#Window_MDI_SavegameManager)
     Windows\SavegameManager\Height=WindowHeight(#Window_MDI_SavegameManager)
    EndIf
    If Windows\Models\State=#PB_Window_Normal
     Windows\Models\x=WindowX(#Window_MDI_Models)
     Windows\Models\y=WindowY(#Window_MDI_Models)
     Windows\Models\Width=WindowWidth(#Window_MDI_Models)
     Windows\Models\Height=WindowHeight(#Window_MDI_Models)
    EndIf
    If Windows\MemoryChanger\State=#PB_Window_Normal
     Windows\MemoryChanger\x=WindowX(#Window_MDI_MemoryChanger)
     Windows\MemoryChanger\y=WindowY(#Window_MDI_MemoryChanger)
     Windows\MemoryChanger\Width=WindowWidth(#Window_MDI_MemoryChanger)
     Windows\MemoryChanger\Height=WindowHeight(#Window_MDI_MemoryChanger)
    EndIf
    If Windows\IMGEditor\State=#PB_Window_Normal
     Windows\IMGEditor\x=WindowX(#Window_MDI_IMGEditor)
     Windows\IMGEditor\y=WindowY(#Window_MDI_IMGEditor)
     Windows\IMGEditor\Width=WindowWidth(#Window_MDI_IMGEditor)
     Windows\IMGEditor\Height=WindowHeight(#Window_MDI_IMGEditor)
    EndIf
    If Windows\CleoManager\State=#PB_Window_Normal
     Windows\CleoManager\x=WindowX(#Window_MDI_CleoManager)
     Windows\CleoManager\y=WindowY(#Window_MDI_CleoManager)
     Windows\CleoManager\Width=WindowWidth(#Window_MDI_CleoManager)
     Windows\CleoManager\Height=WindowHeight(#Window_MDI_CleoManager)
    EndIf
    If Windows\IPLEditor\State=#PB_Window_Normal
     Windows\IPLEditor\x=WindowX(#Window_MDI_IPLEditor)
     Windows\IPLEditor\y=WindowY(#Window_MDI_IPLEditor)
     Windows\IPLEditor\Width=WindowWidth(#Window_MDI_IPLEditor)
     Windows\IPLEditor\Height=WindowHeight(#Window_MDI_IPLEditor)
    EndIf
    If Windows\GameTweaks\State=#PB_Window_Normal
     Windows\GameTweaks\x=WindowX(#Window_MDI_GameTweaks)
     Windows\GameTweaks\y=WindowY(#Window_MDI_GameTweaks)
     Windows\GameTweaks\Width=WindowWidth(#Window_MDI_GameTweaks)
     Windows\GameTweaks\Height=WindowHeight(#Window_MDI_GameTweaks)
    EndIf
    If Windows\Config\State=#PB_Window_Normal
     Windows\Config\x=WindowX(#Window_MDI_Config)
     Windows\Config\y=WindowY(#Window_MDI_Config)
     Windows\Config\Width=WindowWidth(#Window_MDI_Config)
     Windows\Config\Height=WindowHeight(#Window_MDI_Config)
    EndIf
  EndSelect
  CWindow=GetGadgetState(#Gadget_Main_MDI)
   If CWindow<>Config\MDIWindow
    If IsWindow(CWindow)
     Select CWindow
      Case #Window_MDI_Cheats,#Window_MDI_Teleporter,#Window_MDI_SavegameManager,#Window_MDI_Models,#Window_MDI_MemoryChanger,#Window_MDI_IMGEditor,#Window_MDI_CleoManager,#Window_MDI_IPLEditor,#Window_MDI_Config
       SetGadgetState(#Gadget_Main_Panel,CWindow-#Window_MDI_Cheats)
     EndSelect
     Config\MDIWindow=CWindow
    EndIf
   EndIf
  Select WaitWindowEvent(10)
   Case #WM_RBUTTONDOWN
    Select EventWindow()
     Case #Window_Main
      x=WindowMouseX(#Window_Main)
      y=WindowMouseY(#Window_Main)
      If x=>GadgetX(#Gadget_Main_Panel) And x<GadgetX(#Gadget_Main_Panel)+GadgetWidth(#Gadget_Main_Panel) And y=>GadgetY(#Gadget_Main_Panel) And y<GadgetY(#Gadget_Main_Panel)+GadgetHeight(#Gadget_Main_Panel) And Config\UseTabs
       DisplayPopupMenu(#Menu_Panel,WindowID(#Window_Main))
      EndIf
    EndSelect
   Case #PB_Event_Menu
    MenuItem=EventMenu()
    Select MenuItem
     Case #Menu_Main_Login;- Login window
      If Config\SelfCodersAccount\LoggedIn
       Config\SelfCodersAccount\LoggedIn=0
       ReloadMenu()
       MessageRequester("SelfCoders Account","You are now logged off!")
      Else
       If OpenWindow(#Window_Login,100,100,330,160,GetMenuItemText(#Menu_Main,#Menu_Main_Login),#PB_Window_WindowCentered,WindowID(#Window_Main))
        TextGadget(#Gadget_Login_Text1,10,10,100,20,Language(248))
        TextGadget(#Gadget_Login_Text2,10,40,100,20,Language(249))
        ComboBoxGadget(#Gadget_Login_Username,120,10,200,20,#PB_ComboBox_Editable)
        StringGadget(#Gadget_Login_Password,120,40,200,20,Config\SelfCodersAccount\Password,#PB_String_Password)
        CheckBoxGadget(#Gadget_Login_SavePassword,10,80,100,20,"Save password")
        ButtonGadget(#Gadget_Login_OK,WindowWidth(#Window_Login)-220,WindowHeight(#Window_Login)-40,100,30,"Login")
        ButtonGadget(#Gadget_Login_Cancel,GadgetX(#Gadget_Login_OK)+110,GadgetY(#Gadget_Login_OK),100,30,Language(26))
        DisableWindow(#Window_Main,1)
        AddKeyboardShortcut(#Window_Login,#PB_Shortcut_Return,#Menu_Login_OK)
        AddKeyboardShortcut(#Window_Login,#PB_Shortcut_Escape,#Menu_Login_Cancel)
        File=ReadFile(#PB_Any,Common\InstallPath+"LoginUsers.cfg")
         If IsFile(File)
          Repeat
           String$=Trim(StringField(ReadString(File),1,";"))
            If String$
             AddGadgetItem(#Gadget_Login_Username,-1,Trim(StringField(String$,1,Chr(9))))
            EndIf
          Until Eof(File)
          CloseFile(File)
         EndIf
        For User=0 To CountGadgetItems(#Gadget_Login_Username)-1
         If LCase(Trim(GetGadgetItemText(#Gadget_Login_Username,User)))=LCase(Trim(Config\SelfCodersAccount\Username))
          SetGadgetState(#Gadget_Login_Username,User)
          Break
         EndIf
        Next
       EndIf
      EndIf
     Case #Menu_Main_RunScript
      NotFound$=""
      File$=OpenFileRequester(Language(143),"Script.satbs","San Andreas ToolBox Script|*.satbs",0,#PB_Requester_MultiSelection)
       If File$
        While File$
         If IsFileEx(File$)
          RunProgram(Common\InstallPath+"Script.exe",File$,Common\InstallPath)
         Else
          NotFound$+File$+Chr(13)
         EndIf
         File$=NextSelectedFileName()
        Wend
        If NotFound$
         If CountString(NotFound$,Chr(13))=1
          Text$=ReplaceString(Language(20),"%1",GetFilePart(RemoveString(NotFound$,Chr(13),1)),1)
         Else
          Text$=ReplaceString(Language(144),"%1",Str(CountString(NotFound$,Chr(13))),1)
         EndIf
         MessageRequester(Language(19),Text$,#MB_ICONERROR)
        EndIf
       EndIf
     Case #Menu_Main_Quit
      Quit=Quit()
     Case #Menu_Main_Cheats,#Menu_Main_Teleporter,#Menu_Main_SavegameManager,#Menu_Main_Models,#Menu_Main_MemoryChanger,#Menu_Main_IMGEditor,#Menu_Main_CleoManager,#Menu_Main_IPLEditor,#Menu_Main_GameTweaks,#Menu_Main_Config
      Window=MenuItem-#Menu_Main_Cheats+#Window_MDI_Cheats
      HideWindow(Window,0)
      SetWindowState(Window,#PB_Window_Normal)
      BringWindowToTop_(WindowID(Window))
      RefreshWindowMenu()
      SetGadgetState(#Gadget_Main_Panel,Window-#Window_MDI_Cheats)
      Config\MDIWindow=Window
     Case #Menu_Main_Tools
      SetWindowState(#Window_MDI_Tools,#PB_Window_Normal)
      HideWindow(#Window_MDI_Tools,0)
      BringWindowToTop_(WindowID(#Window_MDI_Tools))
     Case #Menu_Main_RunCheatProcessor
      If IsModuleRunning(#Module_CheatProcessor)
       MessageRequester(Language(19),ReplaceString(Language(91),"%1","CheatProcessor",1),#MB_ICONERROR)
      Else
       RunProgram(Common\InstallPath+"CheatProcessor.exe","",Common\InstallPath)
      EndIf
     Case #Menu_Main_RunMemoryServer
      If IsModuleRunning(#Module_MemoryServer)
       MessageRequester(Language(19),ReplaceString(Language(91),"%1","MemoryServer",1),#MB_ICONERROR)
      Else
       RunProgram(Common\InstallPath+"MemoryServer.exe","",Common\InstallPath)
      EndIf
     Case #Menu_Main_RunWebServer
      If IsModuleRunning(#Module_WebServer)
       MessageRequester(Language(19),ReplaceString(Language(91),"%1","WebServer",1),#MB_ICONERROR)
      Else
       RunProgram(Common\InstallPath+"WebServer.exe","",Common\InstallPath)
      EndIf
     Case #Menu_Main_Help
      Select Config\MDIWindow
       Case #Window_MDI_Cheats
        Topic$="Cheats.htm"
       Case #Window_MDI_Teleporter
        Topic$="Teleporter.htm"
       Case #Window_MDI_SavegameManager
        Topic$="SavegameManager.htm"
       Case #Window_MDI_Models
        Topic$="Models.htm"
       Case #Window_MDI_MemoryChanger
        Topic$="MemoryChanger.htm"
       Case #Window_MDI_IMGEditor
        Topic$="IMGEditor.htm"
       Case #Window_MDI_CleoManager
        Topic$="CleoManager.htm"
       Case #Window_MDI_IPLEditor
        Topic$="IPLEditor.htm"
       Case #Window_MDI_GameTweaks
        Topic$="GameTweaks.htm"
       Case #Window_MDI_Config
        Topic$="Settings.htm"
       Case #Window_MDI_TeleportMap
        Topic$="Teleporter.htm"
       Case #Window_MDI_Tools
        Topic$="Tools.htm"
       Default
        Topic$=""
      EndSelect
      Help(Topic$)
     Case #Menu_Main_SearchUpdates
      CheckUpdates(0)
     Case #Menu_Main_ReportBug
      RunProgram(Common\InstallPath+"BugReporter.exe","/Select GUI",Common\InstallPath)
     Case #Menu_Main_ChangeLog
      ChangeLog()
     Case #Menu_Main_About
      If OpenWindow(#Window_About,100,100,ImageWidth(#Image_AboutBanner),400,Language(79),#PB_Window_ScreenCentered,WindowID(#Window_Main))
       ImageGadget(#Gadget_About_Banner,0,0,WindowWidth(#Window_About),ImageHeight(#Image_AboutBanner),ImageID(#Image_AboutBanner))
       EditorGadget(#Gadget_About_Text,0,GadgetHeight(#Gadget_About_Banner),WindowWidth(#Window_About),WindowHeight(#Window_About)-GadgetHeight(#Gadget_About_Banner)-50,#PB_Editor_ReadOnly)
       ButtonGadget(#Gadget_About_Close,WindowWidth(#Window_About)/2-50,WindowHeight(#Window_About)-40,100,30,"Close")
       SetWindowLong_(GadgetID(#Gadget_About_Text),#GWL_EXSTYLE,GetWindowLong_(GadgetID(#Gadget_About_Text),#GWL_EXSTYLE)&(~#WS_EX_CLIENTEDGE))
       SetWindowPos_(GadgetID(#Gadget_About_Text),0,0,0,0,0,#SWP_SHOWWINDOW|#SWP_NOSIZE|#SWP_NOMOVE|#SWP_FRAMECHANGED)
       SendMessage_(GadgetID(#Gadget_About_Text),#EM_SETEVENTMASK,0,$4000000|SendMessage_(GadgetID(#Gadget_About_Text),#EM_GETEVENTMASK,0,0))
       SendMessage_(GadgetID(#Gadget_About_Text),#EM_AUTOURLDETECT,1,0)
       SetWindowCallback(@AboutWindowCB(),#Window_About)
       SetGadgetText(#Gadget_About_Text,ReplaceString(Language(83),"<br>",Chr(13),1))
       DisableWindow(#Window_Main,1)
      EndIf
     Case #Menu_Main_StartGTASA
      Item=0
      If OpenPreferences(GetPathPart(Common\GTAFile)+"Menu.ini")
       If CreatePopupMenu(#Menu_StartGTASA)
        If ExaminePreferenceKeys()
         While NextPreferenceKey()
          If Item<10
           MenuItem(#Menu_StartGTASA_Install1+Item,PreferenceKeyName())
           GTAStartMenu(Item)=PreferenceKeyValue()
           Item+1
          EndIf
         Wend
        EndIf
        DisplayPopupMenu(#Menu_StartGTASA,WindowID(#Window_Main))
       EndIf
      Else
       RunGTA()
      EndIf
     Case #Menu_Panel_UseTabs
      If GetMenuItemState(#Menu_Panel,#Menu_Panel_UseTabs)
       SetMenuItemState(#Menu_Panel,#Menu_Panel_UseTabs,0)
       HideGadget(#Gadget_Main_Panel,1)
      Else
       SetMenuItemState(#Menu_Panel,#Menu_Panel_UseTabs,1)
       HideGadget(#Gadget_Main_Panel,0)
      EndIf
      Config\UseTabs=GetMenuItemState(#Menu_Panel,#Menu_Panel_UseTabs)
      SetGadgetState(#Gadget_Config_UseTabs,Config\UseTabs)
      ReloadMenu()
     Case #Menu_CleoManager_LargeIcon
      Config\CleoManager_ListDisplay=#PB_ListIcon_LargeIcon
      CleoManagerListDisplay()
     Case #Menu_CleoManager_SmallIcon
      Config\CleoManager_ListDisplay=#PB_ListIcon_SmallIcon
      CleoManagerListDisplay()
     Case #Menu_CleoManager_List
      Config\CleoManager_ListDisplay=#PB_ListIcon_List
      CleoManagerListDisplay()
     Case #Menu_CleoManager_Detail
      Config\CleoManager_ListDisplay=#PB_ListIcon_Report
      CleoManagerListDisplay()
     Case #Menu_IPLEditor_EditID
      IPLEditor_Edit(0)
     Case #Menu_IPLEditor_EditModel
      IPLEditor_Edit(1)
     Case #Menu_IPLEditor_EditInterior
      IPLEditor_Edit(2)
     Case #Menu_IPLEditor_EditX
      IPLEditor_Edit(3)
     Case #Menu_IPLEditor_EditY
      IPLEditor_Edit(4)
     Case #Menu_IPLEditor_EditZ
      IPLEditor_Edit(5)
     Case #Menu_IPLEditor_EditUnknown1
      IPLEditor_Edit(6)
     Case #Menu_IPLEditor_EditUnknown2
      IPLEditor_Edit(7)
     Case #Menu_IPLEditor_EditUnknown3
      IPLEditor_Edit(8)
     Case #Menu_IPLEditor_EditUnknown4
      IPLEditor_Edit(9)
     Case #Menu_IPLEditor_EditLOD
      IPLEditor_Edit(10)
     Case #Menu_Login_OK
      SelfCodersAccount_Login()
     Case #Menu_Login_Cancel
      CloseWindow(#Window_Login)
      DisableWindow(#Window_Main,0)
     Case #ToolBar_Cheats_Save
      SaveCheatlist()
     Case #ToolBar_Cheats_Add
      EditCheatWindow(-1)
     Case #ToolBar_Cheats_Remove
      If GetGadgetState(#Gadget_Cheats_List)=-1
       MessageRequester(Language(19),Language(56),#MB_ICONERROR)
      Else
       If MessageRequester(Language(2),Language(59),#MB_YESNO|#MB_ICONQUESTION)=#PB_MessageRequester_Yes
        For Item=0 To CountGadgetItems(#Gadget_Cheats_List)-1
         If GetGadgetItemState(#Gadget_Cheats_List,Item)&#PB_ListIcon_Selected
          SetGadgetItemText(#Gadget_Cheats_List,Item,"?",0)
         EndIf
        Next
        Cheatlist_Remove:
        Count=CountGadgetItems(#Gadget_Cheats_List)-1
        For Item=0 To Count
         If GetGadgetItemText(#Gadget_Cheats_List,Item,0)="?"
          HotkeyData=GetGadgetItemData(#Gadget_Cheats_List,Item)
           If HotkeyData
            FreeMemory(HotkeyData)
           EndIf
          RemoveGadgetItem(#Gadget_Cheats_List,Item)
         EndIf
        Next
        For Item=0 To CountGadgetItems(#Gadget_Cheats_List)-1
         If GetGadgetItemText(#Gadget_Cheats_List,Item,0)="?"
          Goto Cheatlist_Remove
         EndIf
        Next
        If Config\AutoSaveData
         SaveCheatlist()
        EndIf
       EndIf
      EndIf
     Case #ToolBar_Cheats_Edit
      Item=GetGadgetState(#Gadget_Cheats_List)
       If Item<>-1
        EditCheatWindow(Item)
       Else
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       EndIf
     Case #ToolBar_Cheats_Print
      If PrintRequester()
       If StartPrinting("GTA San Andreas ToolBox - "+Language(0))
         If StartDrawing(PrinterOutput())
          For Item=0 To CountGadgetItems(#Gadget_Cheats_List)-1
           Len1=TextWidth(GetGadgetItemText(#Gadget_Cheats_List,Item,0))
           Len2=TextWidth(GetGadgetItemText(#Gadget_Cheats_List,Item,1))
           Len3=TextWidth(GetGadgetItemText(#Gadget_Cheats_List,Item,2))
            If Len1>Length1
             Length1=Len1
            EndIf
            If Len2>Length2
             Length2=Len2
            EndIf
            If Len3>Length3
             Length3=Len3
            EndIf
          Next
          y=250
          Page=0
          Length1+TextWidth("  ")
          Length2+TextWidth("  ")
          Length3+TextWidth("  ")
          For Item=0 To CountGadgetItems(#Gadget_Cheats_List)-1
           If y+TextHeight("TEXT")*2=>PrinterPageHeight() Or Page=0
            If Page
             NewPrinterPage()
            EndIf
            Page+1
            y=250
            Line(250,250,Length1+Length2+Length3,0)
           EndIf
           y+1
           Cheat$=UCase(GetGadgetItemText(#Gadget_Cheats_List,Item,0))
           Name$=GetGadgetItemText(#Gadget_Cheats_List,Item,1)
           Shortcut$=GetGadgetItemText(#Gadget_Cheats_List,Item,2)
           DrawText(250,y," "+Cheat$+" ",0)
           DrawText(250+Length1+1,y," "+Name$+" ",0)
           DrawText(250+Length1+Length2+2,y," "+Shortcut$+" ",0)
           Line(250,y,0,TextHeight("TEXT")+1)
           Line(250+Length1+1,y,0,TextHeight("TEXT")+1)
           Line(250+Length1+Length2+2,y,0,TextHeight("TEXT")+1)
           Line(250+Length1+Length2+Length3+3,y,0,TextHeight("TEXT")+1)
           y+TextHeight("TEXT")+1
           Line(250,y,Length1+Length2+Length3,0)
          Next
          StopDrawing()
         EndIf
        StopPrinting()
       EndIf
      EndIf
     Case #ToolBar_Cheats_Export
      If CreatePopupMenu(#Menu_ExportCheats)
       MenuItem(#Menu_ExportCheats_Excel,"Microsoft Office Excel (xls)")
       MenuItem(#Menu_ExportCheats_Html,"Html Website (htm)")
       DisplayPopupMenu(#Menu_ExportCheats,WindowID(#Window_MDI_Cheats))
      EndIf
     Case #ToolBar_Teleporter_Save
      SaveTeleportlist()
     Case #ToolBar_Teleporter_Add
      Cheat$=UCase(Trim(GetGadgetText(#Gadget_Teleporter_EditCheat)))
      Add=1
      For Place=0 To CountGadgetItems(#Gadget_Teleporter_List)-1
       If UCase(Trim(GetGadgetItemText(#Gadget_Teleporter_List,Place,0)))=Cheat$
        Add=0
       EndIf
      Next
      If Add
       X$=Trim(GetGadgetText(#Gadget_Teleporter_EditX))
       Y$=Trim(GetGadgetText(#Gadget_Teleporter_EditY))
       Z$=Trim(GetGadgetText(#Gadget_Teleporter_EditZ))
        If X$ And Y$ And Z$
         Interior$=GetGadgetText(#Gadget_Teleporter_EditInterior)
         Interior=GetGadgetState(#Gadget_Teleporter_EditInterior)
         AddGadgetItem(#Gadget_Teleporter_List,-1,Cheat$+Chr(10)+X$+Chr(10)+Y$+Chr(10)+Z$+Chr(10)+Interior$)
         SetGadgetItemData(#Gadget_Teleporter_List,CountGadgetItems(#Gadget_Teleporter_List)-1,Interior-1)
         If Config\AutoSaveData
          SaveTeleportlist()
         EndIf
        Else
         MessageRequester(Language(19),Language(234),#MB_ICONERROR)
        EndIf
      Else
       MessageRequester(Language(19),ReplaceString(Language(65),"%1",Cheat$,1),#MB_ICONERROR)
      EndIf
     Case #ToolBar_Teleporter_Remove
      If GetGadgetState(#Gadget_Teleporter_List)=-1
       MessageRequester(Language(19),Language(56),#MB_ICONERROR)
      Else
       If MessageRequester(Language(29),Language(61),#MB_YESNO|#MB_ICONQUESTION)=#PB_MessageRequester_Yes
        For Item=0 To CountGadgetItems(#Gadget_Teleporter_List)-1
         If GetGadgetItemState(#Gadget_Teleporter_List,Item)&#PB_ListIcon_Selected
          SetGadgetItemText(#Gadget_Teleporter_List,Item,"?",0)
         EndIf
        Next
        Teleporter_Remove:
        Count=CountGadgetItems(#Gadget_Teleporter_List)-1
        For Item=0 To Count
         If GetGadgetItemText(#Gadget_Teleporter_List,Item,0)="?"
          RemoveGadgetItem(#Gadget_Teleporter_List,Item)
         EndIf
        Next
        For Item=0 To CountGadgetItems(#Gadget_Teleporter_List)-1
         If GetGadgetItemText(#Gadget_Teleporter_List,Item,0)="?"
          Goto Teleporter_Remove
         EndIf
        Next
        If Config\AutoSaveData
         SaveTeleportlist()
        EndIf
       EndIf
      EndIf
     Case #ToolBar_Teleporter_Edit
      Item=GetGadgetState(#Gadget_Teleporter_List)
       If Item=-1
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       Else
        Cheat$=UCase(Trim(GetGadgetText(#Gadget_Teleporter_EditCheat)))
        Edit=1
        For Place=0 To CountGadgetItems(#Gadget_Teleporter_List)-1
         If UCase(Trim(GetGadgetItemText(#Gadget_Teleporter_List,Place,0)))=Cheat$ And Place<>Item
          Edit=0
         EndIf
        Next
        If Edit
         X$=Trim(GetGadgetText(#Gadget_Teleporter_EditX))
         Y$=Trim(GetGadgetText(#Gadget_Teleporter_EditY))
         Z$=Trim(GetGadgetText(#Gadget_Teleporter_EditZ))
          If X$ And Y$ And Z$
           SetGadgetItemText(#Gadget_Teleporter_List,Item,Cheat$,0)
           SetGadgetItemText(#Gadget_Teleporter_List,Item,X$,1)
           SetGadgetItemText(#Gadget_Teleporter_List,Item,Y$,2)
           SetGadgetItemText(#Gadget_Teleporter_List,Item,Z$,3)
           SetGadgetItemText(#Gadget_Teleporter_List,Item,GetGadgetText(#Gadget_Teleporter_EditInterior),4)
           SetGadgetItemData(#Gadget_Teleporter_List,Item,GetGadgetState(#Gadget_Teleporter_EditInterior)-1)
           If Config\AutoSaveData
            SaveTeleportlist()
           EndIf
          Else
           MessageRequester(Language(19),Language(243),#MB_ICONERROR)
          EndIf
        Else
         MessageRequester(Language(19),ReplaceString(Language(65),"%1",Cheat$,1),#MB_ICONERROR)
        EndIf
       EndIf
     Case #ToolBar_Teleporter_ReadMemory
      If UpdateGTASAProcess()
       PED=ReadProcessValue($B6F3B8,#PB_Long)
       Pool=ReadProcessValue(PED+20,#PB_Long)
       SetGadgetText(#Gadget_Teleporter_EditX,StrF(ReadProcessFloat(Pool+48)))
       SetGadgetText(#Gadget_Teleporter_EditY,StrF(ReadProcessFloat(Pool+52)))
       SetGadgetText(#Gadget_Teleporter_EditZ,StrF(ReadProcessFloat(Pool+56)))
       SetGadgetState(#Gadget_Teleporter_EditInterior,ReadProcessValue($B72914,#PB_Long)+1)
      Else
       MessageRequester(Language(19),Language(156),#MB_ICONERROR)
      EndIf
     Case #ToolBar_Teleporter_ShowMap
      X$=Trim(GetGadgetText(#Gadget_Teleporter_EditX))
      Y$=Trim(GetGadgetText(#Gadget_Teleporter_EditY))
       If X$ And Y$
        x=Val(X$)+3000
        y=SwapMath(Val(Y$)-3000)
       Else
        x=300
        y=300
       EndIf
       Teleporter_ShowMap(x/10,y/10)
     Case #ToolBar_Teleporter_Goto
      If UpdateGTASAProcess()
       X$=Trim(GetGadgetText(#Gadget_Teleporter_EditX))
       Y$=Trim(GetGadgetText(#Gadget_Teleporter_EditY))
       Z$=Trim(GetGadgetText(#Gadget_Teleporter_EditZ))
        If X$ And Y$ And Z$
         x.f=ValF(X$)
         y.f=ValF(Y$)
         z.f=ValF(Z$)
         Interior=GetGadgetState(#Gadget_Teleporter_EditInterior)-1
         Interior$=GetGadgetText(#Gadget_Teleporter_EditInterior)
          If Interior=>0
           LoadInterior(Interior)
          EndIf
         SetPosition(x,y,z)
         MessageRequester("Information",ReplaceString(ReplaceString(ReplaceString(ReplaceString(ReplaceString(Language(152),"<br>",Chr(13),1),"%1",StrF(x,2),1),"%2",StrF(y,2),1),"%3",StrF(z,2),1),"%4",Interior$,1),#MB_ICONINFORMATION)
        Else
         MessageRequester(Language(19),Language(234),#MB_ICONERROR)
        EndIf
      Else
       MessageRequester(Language(19),Language(156),#MB_ICONERROR)
      EndIf
     Case #ToolBar_Teleporter_Savegame
      If CreatePopupMenu(#Menu_SavegameTeleporter)
       OpenSubMenu("Read")
        For Slot=1 To 8
         File=ReadFile(#PB_Any,Config\GTAUserFiles+"GTASAsf"+Str(Slot)+".b")
          If IsFile(File)
           FileSeekEx(File,9)
           MenuItem(#Menu_SavegameTeleporter_ReadSlot1+Slot-1,ReadStringEx(File,$10)+Chr(9)+Str(Slot))
           CloseFile(File)
          EndIf
        Next
       CloseSubMenu()
       OpenSubMenu("Write")
        For Slot=1 To 8
         File=ReadFile(#PB_Any,Config\GTAUserFiles+"GTASAsf"+Str(Slot)+".b")
          If IsFile(File)
           FileSeekEx(File,9)
           MenuItem(#Menu_SavegameTeleporter_WriteSlot1+Slot-1,ReadStringEx(File,$10)+Chr(9)+Str(Slot))
           CloseFile(File)
          EndIf
        Next
       CloseSubMenu()
       DisplayPopupMenu(#Menu_SavegameTeleporter,WindowID(#Window_MDI_Teleporter))
      EndIf
     Case #ToolBar_SavegameManager_Save
      If MessageRequester(Language(238),ReplaceString(Language(239),"<br>",Chr(13),1),#MB_YESNO|#MB_ICONWARNING)=#PB_MessageRequester_Yes
       Item=GetGadgetState(#Gadget_SavegameManager_List)
        If Item<>-1
         File$=Config\GTAUserFiles+GetGadgetItemText(#Gadget_SavegameManager_List,Item,0)
          If IsFileEx(File$)
           File=OpenFile(#PB_Any,File$)
            If IsFile(File)
             Block0=Savegame_SelectBlock(File,0)
             FileSeek(File,Block0+4)
             Name$=Left(Trim(GetGadgetText(#Gadget_SavegameManager_Editor_Name)),99)
             WriteString(File,Name$)
             FileSeek(File,Block0+Len(Name$)+4)
             WriteByte(File,0)
             FileSeek(File,Block0+$86)
             Date=GetGadgetState(#Gadget_SavegameManager_Editor_Clock)
              If Date=1441
               Date=1
              EndIf
             Hour=Date/60
             Minute=Date-Hour*60
             WriteByte(File,Hour)
             WriteByte(File,Minute)
             Block15=Savegame_SelectBlock(File,15)
             FileSeek(File,Block15+4)
             WriteLong(File,Val(Trim(GetGadgetText(#Gadget_SavegameManager_Editor_Money))))
             FileSeek(File,Block15+$23)
             WriteByte(File,Val(Trim(GetGadgetText(#Gadget_SavegameManager_Editor_MaxHealth))))
             WriteByte(File,Val(Trim(GetGadgetText(#Gadget_SavegameManager_Editor_MaxArmor))))
             Savegame_RewriteChecksum(File)
             CloseFile(File)
             MessageRequester("Information","Savegame saved!",#MB_ICONINFORMATION)
            EndIf
          EndIf
        EndIf
      EndIf
     Case #ToolBar_SavegameManager_Edit
      If GetToolBarButtonState(#ToolBar_SavegameManager,#ToolBar_SavegameManager_Edit)
       SavegameEditor(0)
      Else
       SavegameEditor(1)
      EndIf
     Case #ToolBar_SavegameManager_CreateBackup
      File$=SaveFileRequester(Language(22),"Backup.sgb","SaveGameBackup|*.sgb",0)
       If File$
        If IsFileEx(File$)
         Write=MessageRequester(Language(107),ReplaceString(ReplaceString(Language(108),"<br>",Chr(13),1),"%1",GetFilePart(File$),1),#MB_YESNO|#MB_ICONQUESTION)
        Else
         Write=#PB_MessageRequester_Yes
        EndIf
        If Write=#PB_MessageRequester_Yes
         File=CreateFile(#PB_Any,File$)
          If IsFile(File)
           For Chr=1 To Len(#SaveGameBackup_TestString)
            WriteCharacter(File,Asc(Mid(#SaveGameBackup_TestString,Chr,1)))
           Next
           For Slot=1 To 8
            SaveGamePack(Slot)\Offset=-1
            SaveGamePack(Slot)\Size=0
            Save=ReadFile(#PB_Any,Config\GTAUserFiles+"GTASAsf"+Str(Slot)+".b")
             If IsFile(Save)
              Buffer=AllocateMemory(Lof(Save))
               If Buffer
                SaveGamePack(Slot)\Offset=Loc(File)
                SaveGamePack(Slot)\Size=Lof(Save)
                ReadData(Save,Buffer,Lof(Save))
                WriteData(File,Buffer,Lof(Save))
                FreeMemory(Buffer)
               EndIf
              CloseFile(Save)
             EndIf
           Next
           InfoPos=Loc(File)
           For Slot=1 To 8
            WriteLong(File,SaveGamePack(Slot)\Offset)
            WriteLong(File,SaveGamePack(Slot)\Size)
           Next
           WriteLong(File,InfoPos)
           CloseFile(File)
           MessageRequester("Information",Language(197),#MB_ICONINFORMATION)
          Else
           MessageRequester(Language(19),Language(198),#MB_ICONERROR)
          EndIf
        EndIf
       EndIf
     Case #ToolBar_SavegameManager_RestoreBackup
      File$=OpenFileRequester(Language(23),"Backup.sgb","SaveGameBackup|*.sgb",0)
       If File$
        File=ReadFile(#PB_Any,File$)
         If IsFile(File)
          TestString$=""
          For Byte=1 To Len(#SaveGameBackup_TestString)
           TestString$+Chr(ReadCharacter(File))
          Next
          If TestString$=#SaveGameBackup_TestString
           FileSeek(File,Lof(File)-4)
           InfoPos=ReadLong(File)
           FileSeek(File,InfoPos)
           For Slot=1 To 8
            SaveGamePack(Slot)\Offset=ReadLong(File)
            SaveGamePack(Slot)\Size=ReadLong(File)
           Next
           SaveFound=0
           For Slot=1 To 8
            If IsFileEx(Config\GTAUserFiles+"GTASAsf"+Str(Slot)+".b")
             SaveFound=1
            EndIf
           Next
           If SaveFound
            Write=MessageRequester(Language(23),ReplaceString(Language(196),"<br>",Chr(13),1),#MB_YESNO|#MB_ICONWARNING)
           Else
            Write=#PB_MessageRequester_Yes
           EndIf
           If Write
            For Slot=1 To 8
             Save=CreateFile(#PB_Any,Config\GTAUserFiles+"GTASAsf"+Str(Slot)+".b")
              If IsFile(Save)
               If SaveGamePack(Slot)\Offset>-1
                FileSeek(File,SaveGamePack(Slot)\Offset)
                Buffer=AllocateMemory(SaveGamePack(Slot)\Size)
                 If Buffer
                  ReadData(File,Buffer,SaveGamePack(Slot)\Size)
                  WriteData(Save,Buffer,SaveGamePack(Slot)\Size)
                  FreeMemory(Buffer)
                 EndIf
               EndIf
               CloseFile(Save)
              EndIf
            Next
            ReloadSavegames()
            MessageRequester("Information",Language(199),#MB_ICONINFORMATION)
           EndIf
          Else
           MessageRequester(Language(19),ReplaceString(Language(200),"%1",GetFilePart(File$),1),#MB_ICONERROR)
          EndIf
          CloseFile(File)
         Else
          MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
         EndIf
       EndIf
     Case #ToolBar_SavegameManager_Refresh
      ReloadSavegames()
     Case #ToolBar_Models_Save
      Config\IgnoreList_Vehicles=""
      For Item=0 To CountGadgetItems(#Gadget_Models_VehicleList)-1
       If Not GetGadgetItemState(#Gadget_Models_VehicleList,Item)&#PB_ListIcon_Checked
        Config\IgnoreList_Vehicles+GetGadgetItemText(#Gadget_Models_VehicleList,Item,0)+";"
       EndIf
      Next
      If Right(Config\IgnoreList_Vehicles,1)=";"
       Config\IgnoreList_Vehicles=Left(Config\IgnoreList_Vehicles,Len(Config\IgnoreList_Vehicles)-1)
      EndIf
      File=CreateFile(#PB_Any,Common\InstallPath+"Vehicles.cfg")
       If IsFile(File)
        WriteStringN(File,"; ID"+Chr(9)+"Radio"+Chr(9)+"Name")
        For Vehicle=0 To CountGadgetItems(#Gadget_Models_VehicleList)-1
         *Vehicles.Vehicles
         *Vehicles=GetGadgetItemData(#Gadget_Models_VehicleList,Vehicle)
         WriteStringN(File,Str(*Vehicles\ID)+Chr(9)+Str(*Vehicles\Radio)+Chr(9)+Trim(GetGadgetItemText(#Gadget_Models_VehicleList,Vehicle,1)))
        Next
        CloseFile(File)
       EndIf
      SaveSettings()
     Case #ToolBar_Models_Edit;- Edit Models
     Case #ToolBar_Models_AddAsCheat
      Select GetGadgetState(#Gadget_Models_Panel)
       Case 0
        Vehicle=GetGadgetState(#Gadget_Models_VehicleList)
         If Vehicle<>-1
          *Vehicles.Vehicles
          *Vehicles=GetGadgetItemData(#Gadget_Models_VehicleList,Vehicle)
           If *Vehicles\ID=>400 And *Vehicles\ID<=611
            AddCheat("SPAWNVEHICLE"+Str(*Vehicles\ID),ReplaceString(Language(97),"%1",GetGadgetItemText(#Gadget_Models_VehicleList,Item,1),1),"",0,0,0,0,-1)
           EndIf
         EndIf
       Case 1
        Item=GetGadgetState(#Gadget_Models_WeaponList)
         If Item<>-1
          ID=Val(GetGadgetItemText(#Gadget_Models_WeaponList,Item,0))
           If ID
            AddCheat("SPAWNWEAPON"+Str(ID),ReplaceString(Language(97),"%1",GetGadgetItemText(#Gadget_Models_WeaponList,Item,1),1),"",0,0,0,0,-1)
           EndIf
         EndIf
      EndSelect
     Case #ToolBar_Models_Spawn
      SpawnModel()
     Case #ToolBar_Models_Refresh
      If MessageRequester(Language(27),Language(119),#MB_OKCANCEL|#MB_ICONWARNING)=1
       UpdateVehicleList()
      EndIf
     Case #ToolBar_MemoryChanger_Save
      File=CreateFile(#PB_Any,Common\InstallPath+"MemoryChanger.dat")
       If IsFile(File)
        For Item=0 To CountGadgetItems(#Gadget_MemoryChanger_List)-1
         WriteStringN(File,Trim(GetGadgetItemText(#Gadget_MemoryChanger_List,Item,0)))
         WriteLong(File,Hex2Dec(UCase(Trim(GetGadgetItemText(#Gadget_MemoryChanger_List,Item,1)))))
         WriteByte(File,GetGadgetItemData(#Gadget_MemoryChanger_List,Item))
        Next
        CloseFile(File)
       EndIf
     Case #ToolBar_MemoryChanger_Add
      Address$=UCase(Trim(GetGadgetText(#Gadget_MemoryChanger_Address)))
       If Address$
        AddGadgetItem(#Gadget_MemoryChanger_List,-1,GetGadgetText(#Gadget_MemoryChanger_Name)+Chr(10)+Address$+Chr(10)+GetGadgetText(#Gadget_MemoryChanger_DataType))
        SetGadgetItemData(#Gadget_MemoryChanger_List,CountGadgetItems(#Gadget_MemoryChanger_List)-1,GetGadgetState(#Gadget_MemoryChanger_DataType))
       Else
        MessageRequester(Language(19),Language(140),#MB_ICONERROR)
       EndIf
     Case #ToolBar_MemoryChanger_Set
      Item=GetGadgetState(#Gadget_MemoryChanger_List)
       If Item=-1
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       Else
        Address$=UCase(Trim(GetGadgetText(#Gadget_MemoryChanger_Address)))
         If Address$
          SetGadgetItemText(#Gadget_MemoryChanger_List,Item,GetGadgetText(#Gadget_MemoryChanger_Name),0)
          SetGadgetItemText(#Gadget_MemoryChanger_List,Item,Address$,1)
          SetGadgetItemText(#Gadget_MemoryChanger_List,Item,GetGadgetText(#Gadget_MemoryChanger_DataType),2)
          SetGadgetItemData(#Gadget_MemoryChanger_List,Item,GetGadgetState(#Gadget_MemoryChanger_DataType))
         Else
          MessageRequester(Language(19),Language(140),#MB_ICONERROR)
         EndIf
       EndIf
     Case #ToolBar_MemoryChanger_Remove
      Item=GetGadgetState(#Gadget_MemoryChanger_List)
       If Item=1
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       Else
        RemoveGadgetItem(#Gadget_MemoryChanger_List,Item)
       EndIf
     Case #ToolBar_MemoryChanger_Clear
      If CountGadgetItems(#Gadget_MemoryChanger_List)
       If MessageRequester(Language(125),Language(126),#MB_YESNO|#MB_ICONQUESTION)=#PB_MessageRequester_Yes
        ClearGadgetItems(#Gadget_MemoryChanger_List)
       EndIf
      Else
       MessageRequester(Language(19),Language(127),#MB_ICONERROR)
      EndIf
     Case #ToolBar_MemoryChanger_ReadMemory
      If UpdateGTASAProcess()
       ReloadMemoryChangerList()
      Else
       MessageRequester(Language(19),Language(156),#MB_ICONERROR)
      EndIf
     Case #ToolBar_MemoryChanger_WriteMemory
      If UpdateGTASAProcess()
       Offset$=Trim(GetGadgetText(#Gadget_MemoryChanger_Address))
        If Offset$
         Offset=Hex2Dec(Offset$)
         DataType=GetGadgetState(#Gadget_MemoryChanger_DataType)
         Value$=GetGadgetText(#Gadget_MemoryChanger_Value)
         Select DataType
          Case #PB_Byte,#PB_Word,#PB_Character,#PB_Long
           If IsValidString(Trim(Value$),"-+0123456789")=Trim(Value$)
            WriteProcessValue(Offset,Val(Value$),DataType)
           Else
            MessageRequester(Language(19),ReplaceString(Language(153),"%1",DataType(DataType,1),1),#MB_ICONERROR)
           EndIf
          Case #PB_Float,#PB_Double,#PB_Quad
           If IsValidString(Trim(Value$),"-+0123456789.")=Trim(Value$)
            WriteProcessFloat(Offset,ValF(Value$))
           Else
            MessageRequester(Language(19),ReplaceString(Language(153),"%1",DataType(DataType,1),1),#MB_ICONERROR)
           EndIf
          Case #PB_String
           WriteProcessString(Offset,Value$)
          Default
           MessageRequester(Language(19),Language(154),#MB_ICONERROR)
         EndSelect
         ReloadMemoryChangerList()
        Else
         MessageRequester(Language(19),Language(155),#MB_ICONERROR)
        EndIf
      Else
       MessageRequester(Language(19),Language(156),#MB_ICONERROR)
      EndIf
     Case #ToolBar_IMGEditor_Open
      If IsThread(Config\OpenIMG_ThreadID)
       MessageRequester(Language(19),Language(102),#MB_ICONERROR)
      Else
       File$=OpenFileRequester(Language(100),Config\IMGEditor_ArchiveFile,Language(101),0)
        If File$
         If IsFileEx(File$)
          If Config\IMGEditor_ArchiveChanged
           Open=MessageRequester(Language(100),ReplaceString(Language(133),"<br>",Chr(13),1),#MB_YESNO|#MB_ICONQUESTION)
          Else
           Open=#PB_MessageRequester_Yes
          EndIf
          If Open=#PB_MessageRequester_Yes
           Config\OpenIMG_ThreadID=CreateThread(@IMG_OpenEx(),@File$)
          EndIf
         Else
          MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
         EndIf
        EndIf
      EndIf
     Case #ToolBar_IMGEditor_Export
      Item=GetGadgetState(#Gadget_IMGEditor_List)
       If Item<>-1
        File$=GetGadgetItemText(#Gadget_IMGEditor_List,Item,0)
        Ext$=LCase(GetExtensionPart(File$))
        ExtName$=GetFileType(Ext$)
        Save$=SaveFileRequester(Language(103),File$,ExtName$+" (*."+Ext$+")|*."+Ext$+"|"+Language(106),0)
         If Save$
          If SelectedFilePattern()=0
           Save$=GetFileName(Save$)+"."+Ext$
          EndIf
          If IsFileEx(Save$)
           Replace=MessageRequester(Language(107),ReplaceString(ReplaceString(Language(108),"%1",GetFilePart(Save$),1),"<br>",Chr(13),1),#MB_YESNO|#MB_ICONQUESTION)
          Else
           Replace=#PB_MessageRequester_Yes
          EndIf
          If Replace=#PB_MessageRequester_Yes
           ForEach IMGFiles()
            If LCase(IMGFiles()\Name)=LCase(File$)
             IMG_ExportFile(ListIndex(IMGFiles()),Save$)
            EndIf
           Next
          EndIf
         EndIf
       Else
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       EndIf
     Case #ToolBar_IMGEditor_Replace;- IMG
     Case #ToolBar_IMGEditor_Delete
     Case #ToolBar_IMGEditor_Insert
     Case #ToolBar_GameTweaks_Read
      SetGadgetState(#Gadget_GameTweaks_FatState,ReadProcessFloat($B793D4))
      SetGadgetState(#Gadget_GameTweaks_StaminaState,ReadProcessFloat($B793D8))
      SetGadgetState(#Gadget_GameTweaks_MuscleState,ReadProcessFloat($B793DC))
      SetGadgetState(#Gadget_GameTweaks_HealthState,ReadProcessFloat($B793E0))
      SetGadgetState(#Gadget_GameTweaks_SexAppealState,ReadProcessFloat($B793E4))
      SetGadgetState(#Gadget_GameTweaks_PistolState,ReadProcessFloat($B79494))
      SetGadgetState(#Gadget_GameTweaks_SilencedPistolState,ReadProcessFloat($B79498))
      SetGadgetState(#Gadget_GameTweaks_DesertEagleState,ReadProcessFloat($B7949C))
      SetGadgetState(#Gadget_GameTweaks_ShotgunState,ReadProcessFloat($B794A0))
      SetGadgetState(#Gadget_GameTweaks_SawnoffShotgunState,ReadProcessFloat($B794A4))
      SetGadgetState(#Gadget_GameTweaks_CombatShotgunState,ReadProcessFloat($B794A8))
      SetGadgetState(#Gadget_GameTweaks_MachinePistolState,ReadProcessFloat($B794AC))
      SetGadgetState(#Gadget_GameTweaks_SMGState,ReadProcessFloat($B794B0))
      SetGadgetState(#Gadget_GameTweaks_AK47State,ReadProcessFloat($B794B4))
      SetGadgetState(#Gadget_GameTweaks_M4State,ReadProcessFloat($B794B8))
      ; Denise = 0xB79210 - 4 Bytes
      ; Michelle = 0xB79214 - 4 Bytes
      ; Katie = 0xB79220 - 4 Bytes
     Case #ToolBar_GameTweaks_Write
      WriteProcessFloat($B793D4,GetGadgetState(#Gadget_GameTweaks_FatState))
      WriteProcessFloat($B793D8,GetGadgetState(#Gadget_GameTweaks_StaminaState))
      WriteProcessFloat($B793DC,GetGadgetState(#Gadget_GameTweaks_MuscleState))
      WriteProcessFloat($B793E0,GetGadgetState(#Gadget_GameTweaks_HealthState))
      WriteProcessFloat($B793E4,GetGadgetState(#Gadget_GameTweaks_SexAppealState))
      WriteProcessFloat($B79494,GetGadgetState(#Gadget_GameTweaks_PistolState))
      WriteProcessFloat($B79498,GetGadgetState(#Gadget_GameTweaks_SilencedPistolState))
      WriteProcessFloat($B7949C,GetGadgetState(#Gadget_GameTweaks_DesertEagleState))
      WriteProcessFloat($B794A0,GetGadgetState(#Gadget_GameTweaks_ShotgunState))
      WriteProcessFloat($B794A4,GetGadgetState(#Gadget_GameTweaks_SawnoffShotgunState))
      WriteProcessFloat($B794A8,GetGadgetState(#Gadget_GameTweaks_CombatShotgunState))
      WriteProcessFloat($B794AC,GetGadgetState(#Gadget_GameTweaks_MachinePistolState))
      WriteProcessFloat($B794B0,GetGadgetState(#Gadget_GameTweaks_SMGState))
      WriteProcessFloat($B794B4,GetGadgetState(#Gadget_GameTweaks_AK47State))
      WriteProcessFloat($B794B8,GetGadgetState(#Gadget_GameTweaks_M4State))
      ; Denise = 0xB79210 - 4 Bytes
      ; Michelle = 0xB79214 - 4 Bytes
      ; Katie = 0xB79220 - 4 Bytes
     Case #ToolBar_Config_Save
      Config\RememberMDI=GetGadgetState(#Gadget_Config_RememberMDI)
      Config\MinimizeToTray=GetGadgetState(#Gadget_Config_MinimizeToTray)
      Config\StartMinimized=GetGadgetState(#Gadget_Config_StartMinimized)
      Config\DisplayMessages=GetGadgetState(#Gadget_Config_DisplayMessages)
      Select GetGadgetState(#Gadget_Config_Language)
       Case 0
        Config\Language=#LANG_ENGLISH
       Case 1
        Config\Language=#LANG_GERMAN
      EndSelect
      Config\QuitConfirm=GetGadgetState(#Gadget_Config_QuitConfirm)
      Config\UseTabs=GetGadgetState(#Gadget_Config_UseTabs)
      Config\DisableGTASplash=GetGadgetState(#Gadget_Config_DisableGTASplash)
      Config\CloseModulesOnQuit=GetGadgetState(#Gadget_Config_CloseModulesOnQuit)
      Config\AutoCheckUpdates=GetGadgetState(#Gadget_Config_AutoCheckUpdates)
      Config\AutoSaveData=GetGadgetState(#Gadget_Config_AutoSaveData)
      Config\UseCheatSound=GetGadgetState(#Gadget_Config_UseCheatSound)
      Config\CheatSound=GetGadgetText(#Gadget_Config_CheatSound)
      Common\GTAFile=GetGadgetText(#Gadget_Config_GTAFile)
      Config\Server_Port=Val(GetGadgetText(#Gadget_Config_ServerPort))
      Config\Startup_CheatProcessor=GetGadgetState(#Gadget_Config_StartupCheatProcessor)
      Config\Startup_MemoryServer=GetGadgetState(#Gadget_Config_StartupmemoryServer)
      Config\Startup_WebServer=GetGadgetState(#Gadget_Config_StartupWebServer)
      Config\UseBackground=GetGadgetState(#Gadget_Config_UseBackground)
      Config\BackgroundFile=GetGadgetText(#Gadget_Config_Background)
      Config\ActivateCheat=""
      For Cheat=0 To CountGadgetItems(#Gadget_Config_CheatProcessorList)-1
       Config\ActivateCheat+GetGadgetItemText(#Gadget_Config_CheatProcessorList,Cheat)+";"
      Next
      Config\ActivateCheat=Left(Config\ActivateCheat,Len(Config\ActivateCheat)-1)
      If GetGadgetState(#Gadget_Config_ImageTypeBMP)
       Config\ImageType=#PB_ImagePlugin_BMP
      ElseIf GetGadgetState(#Gadget_Config_ImageTypeJPG)
       Config\ImageType=#PB_ImagePlugin_JPEG
      ElseIf GetGadgetState(#Gadget_Config_ImageTypePNG)
       Config\ImageType=#PB_ImagePlugin_PNG
      Else
       Config\ImageType=#PB_ImagePlugin_JPEG
      EndIf
      If GetGadgetState(#Gadget_Config_MapType2D)
       Config\MapType=200
      ElseIf GetGadgetState(#Gadget_Config_MapType3D)
       Config\MapType=300
      Else
       Config\MapType=200
      EndIf
      If Config\UseTabs
       HideGadget(#Gadget_Main_Panel,0)
      Else
       HideGadget(#Gadget_Main_Panel,1)
      EndIf
      SaveSettings()
      SetConfig()
      LoadMap()
      RefreshLanguage()
      LoadBackground()
      If IsWindow(#Window_MDI_Help)
       ReloadHelpFiles()
       Help(Config\HelpTopic)
      EndIf
     Case #ToolBar_Tools_Add
      File$=OpenFileRequester(Language(111),"",Language(106),0,#PB_Requester_MultiSelection)
       If File$
        While File$
         If IsFileEx(File$)
          AddGadgetItem(#Gadget_Tools_List,-1,GetFileName(GetFilePart(File$))+Chr(10)+File$,ExtractIcon_(0,File$,0))
         Else
          MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
         EndIf
         File$=NextSelectedFileName()
        Wend
       EndIf
     Case #ToolBar_Tools_Remove
      Item=GetGadgetState(#Gadget_Tools_List)
       If Item<>-1
        RemoveGadgetItem(#Gadget_Tools_List,Item)
       EndIf
     Case #ToolBar_Tools_Edit
      If CreatePopupMenu(#Menu_Tools)
       MenuItem(#Menu_Tools_EditName,"Name")
       MenuItem(#Menu_Tools_EditFile,Language(7))
       MenuItem(#Menu_Tools_EditParameter,"Parameter")
      EndIf
      DisplayPopupMenu(#Menu_Tools,WindowID(#Window_MDI_Tools))
     Case #ToolBar_Tools_AddBar
      Item=GetGadgetState(#Gadget_Tools_List)
      AddGadgetItem(#Gadget_Tools_List,Item+1,"{MenuBar}")
      If Item=-1
       Item=CountGadgetItems(#Gadget_Tools_List)-1
      Else
       Item+1
      EndIf
      SetGadgetItemData(#Gadget_Tools_List,Item,#Tools_Separator)
     Case #ToolBar_Tools_OpenSubMenu
      Name$=Trim(InputRequester(Language(203),Language(205),Language(206)))
       If Name$
        Item=GetGadgetState(#Gadget_Tools_List)
        AddGadgetItem(#Gadget_Tools_List,Item+1,Name$)
        If Item=-1
         Item=CountGadgetItems(#Gadget_Tools_List)-1
        Else
         Item+1
        EndIf
        SetGadgetItemData(#Gadget_Tools_List,Item,#Tools_OpenSubMenu)
       EndIf
     Case #ToolBar_Tools_CloseSubMenu
      Item=GetGadgetState(#Gadget_Tools_List)
      AddGadgetItem(#Gadget_Tools_List,Item+1,"{CloseSubMenu}")
      If Item=-1
       Item=CountGadgetItems(#Gadget_Tools_List)-1
      Else
       Item+1
      EndIf
      SetGadgetItemData(#Gadget_Tools_List,Item,#Tools_CloseSubMenu)
     Case #Toolbar_Tools_MoveUp
      Tool=GetGadgetState(#Gadget_Tools_List)
       If Tool=-1
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       Else
        If CountGadgetItems(#Gadget_Tools_List)>1
         Name$=Trim(GetGadgetItemText(#Gadget_Tools_List,Tool,0))
         File$=Trim(GetGadgetItemText(#Gadget_Tools_List,Tool,1))
         Parameter$=Trim(GetGadgetItemText(#Gadget_Tools_List,Tool,2))
         Type=GetGadgetItemData(#Gadget_Tools_List,Tool)
         If Tool=0
          MoveTo=CountGadgetItems(#Gadget_Tools_List)-1
         Else
          MoveTo=Tool-1
         EndIf
         RemoveGadgetItem(#Gadget_Tools_List,Tool)
         AddGadgetItem(#Gadget_Tools_List,MoveTo,Name$+Chr(10)+File$+Chr(10)+Parameter$,ExtractIcon_(0,File$,0))
         SetGadgetItemData(#Gadget_Tools_List,MoveTo,Type)
         SetGadgetState(#Gadget_Tools_List,MoveTo)
        EndIf
       EndIf
     Case #Toolbar_Tools_MoveDown
      Tool=GetGadgetState(#Gadget_Tools_List)
       If Tool=-1
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       Else
        If CountGadgetItems(#Gadget_Tools_List)>1
         Name$=Trim(GetGadgetItemText(#Gadget_Tools_List,Tool,0))
         File$=Trim(GetGadgetItemText(#Gadget_Tools_List,Tool,1))
         Parameter$=Trim(GetGadgetItemText(#Gadget_Tools_List,Tool,2))
         Type=GetGadgetItemData(#Gadget_Tools_List,Tool)
         If Tool=CountGadgetItems(#Gadget_Tools_List)-1
          MoveTo=0
         Else
          MoveTo=Tool+1
         EndIf
         RemoveGadgetItem(#Gadget_Tools_List,Tool)
         AddGadgetItem(#Gadget_Tools_List,MoveTo,Name$+Chr(10)+File$+Chr(10)+Parameter$,ExtractIcon_(0,File$,0))
         SetGadgetItemData(#Gadget_Tools_List,MoveTo,Type)
         SetGadgetState(#Gadget_Tools_List,MoveTo)
        EndIf
       EndIf
     Case #ToolBar_Tools_RefreshMenu
      ReloadMenu()
     Case #ToolBar_Help_Back
      SetGadgetState(#Gadget_Help_Web,#PB_Web_Back)
     Case #ToolBar_Help_Next
      SetGadgetState(#Gadget_Help_Web,#PB_Web_Forward)
     Case #ToolBar_Help_Home
      SetGadgetText(#Gadget_Help_Web,Config\HelpDir+"Introduction.htm")
     Case #Menu_ExportCheats_Excel;- Export Excel Sheet
      MessageRequester("Export as Excel Sheet","Not available yet")
     Case #Menu_ExportCheats_Html;- Export Html-Document
      TemplateFile=ReadFile(#PB_Any,Common\InstallPath+"Export.htm")
       If IsFile(TemplateFile)
        File$=SaveFileRequester("Save Html-Document","Cheats.html","Html-Document|*.htm;*.html|All files|*.*",0)
         If File$
          If Trim(GetExtensionPart(File$))="" And SelectedFilePattern()=0
           File$+".html"
          EndIf
          If IsFileEx(File$)
           Write=MessageRequester(Language(107),ReplaceString(ReplaceString(Language(108),"<br>",Chr(13),1),"%1",GetFilePart(File$),1),#MB_YESNO|#MB_ICONWARNING)
          Else
           Write=#PB_MessageRequester_Yes
          EndIf
          If Write=#PB_MessageRequester_Yes
           File=CreateFile(#PB_Any,File$)
            If IsFile(File)
             WriteList=0
             Repeat
              String$=ReadString(TemplateFile)
              String$=ReplaceString(String$,"%Title%","GTA San Andreas ToolBox - Cheats",1)
              String$=ReplaceString(String$,"%Cheat%",Language(3),1)
              String$=ReplaceString(String$,"%Description%",Language(4),1)
              String$=ReplaceString(String$,"%Shortcut%",Language(5),1)
              String$=ReplaceString(String$,"%Signature%","Created by <a href=http://www.selfcoders.com/?page=downloads&download=gta_sa_toolbox>GTA San Andreas ToolBox v2.00</a>",1)
               Select LCase(Trim(String$))
                Case "<cheatlist>"
                 WriteList=1
                Case "</cheatlist>"
                 If WriteList
                  For Cheat=0 To CountGadgetItems(#Gadget_Cheats_List)-1
                   Cheat$=UCase(Trim(GetGadgetItemText(#Gadget_Cheats_List,Cheat,0)))
                   Description$=Trim(GetGadgetItemText(#Gadget_Cheats_List,Cheat,1))
                   Shortcut$=Trim(GetGadgetItemText(#Gadget_Cheats_List,Cheat,2))
                   Item$=""
                   ForEach ExportHtml()
                    Item$+ExportHtml()
                    If ListIndex(ExportHtml())<ListSize(ExportHtml())-1
                     Item$+Chr(13)+Chr(10)
                    EndIf
                   Next
                   Item$=ReplaceString(Item$,"%List_Cheat%",Cheat$,1)
                   Item$=ReplaceString(Item$,"%List_Description%",Description$,1)
                   Item$=ReplaceString(Item$,"%List_Shortcut%",Shortcut$,1)
                   WriteStringN(File,Item$)
                  Next
                 EndIf
                 WriteList=0
                Default
                 If WriteList
                  AddElement(ExportHtml())
                  ExportHtml()=String$
                 Else
                  WriteStringN(File,String$)
                 EndIf
               EndSelect
             Until Eof(TemplateFile)
             CloseFile(File)
            EndIf
          EndIf
         EndIf
        CloseFile(TemplateFile)
       Else
        MessageRequester(Language(19),Language(255),#MB_ICONERROR)
       EndIf
     Case #Menu_SavegameTeleporter_ReadSlot1,#Menu_SavegameTeleporter_ReadSlot2,#Menu_SavegameTeleporter_ReadSlot3,#Menu_SavegameTeleporter_ReadSlot4,#Menu_SavegameTeleporter_ReadSlot5,#Menu_SavegameTeleporter_ReadSlot6,#Menu_SavegameTeleporter_ReadSlot7,#Menu_SavegameTeleporter_ReadSlot8
      File=ReadFile(#PB_Any,Config\GTAUserFiles+"GTASAsf"+Str(MenuItem-#Menu_SavegameTeleporter_ReadSlot1+1)+".b")
       If IsFile(File)
        Savegame_SelectBlock(File,0,$C4)
        SetGadgetState(#Gadget_Teleporter_EditInterior,ReadLong(File)+1)
        Savegame_SelectBlock(File,2,$14)
        SetGadgetText(#Gadget_Teleporter_EditX,StrF(ReadFloat(File)))
        SetGadgetText(#Gadget_Teleporter_EditY,StrF(ReadFloat(File)))
        SetGadgetText(#Gadget_Teleporter_EditZ,StrF(ReadFloat(File)))
        CloseFile(File)
       EndIf
     Case #Menu_SavegameTeleporter_WriteSlot1,#Menu_SavegameTeleporter_WriteSlot2,#Menu_SavegameTeleporter_WriteSlot3,#Menu_SavegameTeleporter_WriteSlot4,#Menu_SavegameTeleporter_WriteSlot5,#Menu_SavegameTeleporter_WriteSlot6,#Menu_SavegameTeleporter_WriteSlot7,#Menu_SavegameTeleporter_WriteSlot8
      File$=Config\GTAUserFiles+"GTASAsf"+Str(MenuItem-#Menu_SavegameTeleporter_WriteSlot1+1)+".b"
       If IsFileEx(File$)
        If MessageRequester(Language(21),ReplaceString(ReplaceString(Language(235),"<br>",Chr(13),1),"%1",GetFilePart(File$),1),#MB_OKCANCEL|#MB_ICONWARNING)=1
         File=OpenFile(#PB_Any,File$)
          If IsFile(File)
           Interior=GetGadgetState(#Gadget_Teleporter_EditInterior)-1
            If Interior<>-1
             Savegame_SelectBlock(File,0,$C4)
             WriteLong(File,Interior)
            EndIf
           Savegame_SelectBlock(File,2,$14)
           WriteFloat(File,ValF(GetGadgetText(#Gadget_Teleporter_EditX)))
           WriteFloat(File,ValF(GetGadgetText(#Gadget_Teleporter_EditY)))
           WriteFloat(File,ValF(GetGadgetText(#Gadget_Teleporter_EditZ)))
           Savegame_RewriteChecksum(File)
           CloseFile(File)
           MessageRequester("Information",Language(236),#MB_ICONINFORMATION)
          EndIf
        EndIf
       Else
        MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
       EndIf
     Case #Menu_Models_Radio
      Vehicle=GetGadgetState(#Gadget_Models_VehicleList)
       If Vehicle<>-1
        *Vehicles.Vehicles
        *Vehicles=GetGadgetItemData(#Gadget_Models_VehicleList,Vehicle)
        If *Vehicles\Radio=1
         *Vehicles\Radio=0
         SetGadgetItemText(#Gadget_Models_VehicleList,Vehicle,Language(243),3)
        Else
         *Vehicles\Radio=1
          SetGadgetItemText(#Gadget_Models_VehicleList,Vehicle,Language(242),3)
        EndIf
       Else
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       EndIf
     Case #Menu_Models_EditName
      Vehicle=GetGadgetState(#Gadget_Models_VehicleList)
       If Vehicle<>-1
        Name$=Trim(InputRequester(Language(251),Language(252),GetGadgetItemText(#Gadget_Models_VehicleList,Vehicle,1)))
         If Name$
          SetGadgetItemText(#Gadget_Models_VehicleList,Vehicle,Name$,1)
         EndIf
       Else
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       EndIf
     Case #Menu_Tools_EditName
      Item=GetGadgetState(#Gadget_Tools_List)
       If Item<>-1
        Name$=Trim(InputRequester(Language(128),Language(129),GetGadgetItemText(#Gadget_Tools_List,Item,0)))
         If Name$
          SetGadgetItemText(#Gadget_Tools_List,Item,Name$,0)
         EndIf
       Else
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       EndIf
     Case #Menu_Tools_EditFile
      Item=GetGadgetState(#Gadget_Tools_List)
       If Item<>-1
        File$=OpenFileRequester(Language(130),GetGadgetItemText(#Gadget_Tools_List,Item,1),Language(106),0)
         If File$
          If IsFileEx(File$)
           SetGadgetItemText(#Gadget_Tools_List,Item,File$,1)
          Else
           MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
          EndIf
         EndIf
       Else
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       EndIf
     Case #Menu_Tools_EditParameter
      Item=GetGadgetState(#Gadget_Tools_List)
       If Item<>-1
        Parameter$=Trim(InputRequester(Language(131),Language(132),GetGadgetItemText(#Gadget_Tools_List,Item,2)))
         If Parameter$
          SetGadgetItemText(#Gadget_Tools_List,Item,Parameter$,2)
         EndIf
       Else
        MessageRequester(Language(19),Language(56),#MB_ICONERROR)
       EndIf
     Case #Menu_Tray_ShowWindow
      RestoreWindow()
     Case #Menu_Tray_StartGTASA
      RunGTA()
     Default
      If MenuItem=>#Menu_StartGTASA_Install1 And MenuItem<=#Menu_StartGTASA_Install10
       Path$=GTAStartMenu(MenuItem-#Menu_StartGTASA_Install1)
       If IsFileEx(Path$+"gta_sa.exe")
        RunGTA(Path$+"gta_sa.exe")
       Else
        MessageRequester(Language(19),ReplaceString(Language(124),"%1",Path$,1),#MB_ICONERROR)
       EndIf
      ElseIf MenuItem=>#Menu_FirstExternTool And MenuItem<=#Menu_FirstExternTool+99
       File$=GetGadgetItemText(#Gadget_Tools_List,MenuItem-#Menu_FirstExternTool,1)
       Parameter$=GetGadgetItemText(#Gadget_Tools_List,MenuItem-#Menu_FirstExternTool,2)
        If IsFileEx(File$)
         If LCase(GetExtensionPart(File$))="goto"
          File=ReadFile(#PB_Any,File$)
           If IsFile(File)
            File$=Trim(ReadString(File))
            CloseFile(File)
           EndIf
         EndIf
         RunProgram(File$,Parameter$,GetPathPart(File$))
        Else
         MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
        EndIf
      EndIf
    EndSelect
   Case #PB_Event_Gadget
    Select EventGadget()
     Case #Gadget_Main_Panel
      Item=GetGadgetState(#Gadget_Main_Panel)
       If Item<>-1
        CWindow=Item+#Window_MDI_Cheats
        For Window=#Window_MDI_Cheats To #Window_MDI_Config
         If Window<>CWindow
          HideWindow(Window,1)
         EndIf
        Next
        HideWindow(CWindow,0)
        SetWindowState(CWindow,#PB_Window_Maximize)
        BringWindowToTop_(WindowID(CWindow))
        RefreshWindowMenu()
       EndIf
     Case #Gadget_Cheats_List
      Item=GetGadgetState(#Gadget_Cheats_List)
       If Item<>-1
        Select EventType()
         Case #PB_EventType_LeftDoubleClick
          EditCheatWindow(Item)
        EndSelect
       EndIf
     Case #Gadget_Models_Panel
      Select GetGadgetState(#Gadget_Models_Panel)
       Case 0
        If IsImage(#Image_Models_Vehicle1)
         SetModelsImage(#Image_Models_Vehicle1,#Image_Models_Vehicle2)
        EndIf
       Case 1
        If IsImage(#Image_Models_Weapon1)
         SetModelsImage(#Image_Models_Weapon1,#Image_Models_Weapon2)
        EndIf
      EndSelect
     Case #Gadget_Models_VehicleList
      Item=GetGadgetState(#Gadget_Models_VehicleList)
       If Item<>-1
        File$=Common\InstallPath+"Images\"+GetGadgetItemText(#Gadget_Models_VehicleList,Item,0)+".jpg"
         If LoadImageEx(#Image_Models_Vehicle1,File$,400,350,1)
          SetModelsImage(#Image_Models_Vehicle1,#Image_Models_Vehicle2)
         EndIf
       EndIf
      Select EventType()
       Case #PB_EventType_LeftDoubleClick
        SpawnModel()
       Case #PB_EventType_RightClick
        Vehicle=GetGadgetState(#Gadget_Models_VehicleList)
         If Vehicle<>-1
          If CreatePopupMenu(#Menu_Models)
           ;MenuItem(#ToolBar_Models_Edit,Language(92)):DisableMenuItem(#Menu_Models,#ToolBar_Models_Edit,1)
           MenuItem(#ToolBar_Models_AddAsCheat,Language(96))
           MenuItem(#ToolBar_Models_Spawn,Language(94))
            MenuBar()
           OpenSubMenu(Language(92))
            MenuItem(#Menu_Models_Radio,"Radio")
             MenuBar()
            MenuItem(#Menu_Models_EditName,"Name")
           CloseSubMenu()
          EndIf
          *Vehicles.Vehicles
          *Vehicles=GetGadgetItemData(#Gadget_Models_VehicleList,Vehicle)
          If *Vehicles\Radio=1
           SetMenuItemState(#Menu_Models,#Menu_Models_Radio,1)
          EndIf
          DisplayPopupMenu(#Menu_Models,WindowID(#Window_Main))
         EndIf
      EndSelect
     Case #Gadget_Models_WeaponList
      Item=GetGadgetState(#Gadget_Models_WeaponList)
       If Item<>-1
        File$=Common\InstallPath+"Images\"+GetGadgetItemText(#Gadget_Models_WeaponList,Item,2)+".jpg"
         If LoadImageEx(#Image_Models_Weapon1,File$,300,300,1)
          SetModelsImage(#Image_Models_Weapon1,#Image_Models_Weapon2)
         EndIf
       EndIf
      Select EventType()
       Case #PB_EventType_LeftDoubleClick
        SpawnModel()
       Case #PB_EventType_RightClick
        If GetGadgetState(#Gadget_Models_WeaponList)<>-1
         If CreatePopupMenu(#Menu_Models)
          MenuItem(#ToolBar_Models_Edit,Language(92)):DisableMenuItem(#Menu_Models,#ToolBar_Models_Edit,1)
          MenuItem(#ToolBar_Models_AddAsCheat,Language(96))
          MenuItem(#ToolBar_Models_Spawn,Language(94))
         EndIf
         DisplayPopupMenu(#Menu_Models,WindowID(#Window_Main))
        EndIf
      EndSelect
     Case #Gadget_Models_Splitter
      Select GetGadgetState(#Gadget_Models_Panel)
       Case 0
        If IsImage(#Image_Models_Vehicle1)
         SetModelsImage(#Image_Models_Vehicle1,#Image_Models_Vehicle2)
        EndIf
       Case 1
        If IsImage(#Image_Models_Weapon1)
         SetModelsImage(#Image_Models_Weapon1,#Image_Models_Weapon2)
        EndIf
      EndSelect
      ResizeGadget(#Gadget_Models_VehicleList,0,0,GetGadgetAttribute(#Gadget_Models_Panel,#PB_Panel_ItemWidth),GetGadgetAttribute(#Gadget_Models_Panel,#PB_Panel_ItemHeight))
      ResizeGadget(#Gadget_Models_WeaponList,0,0,GetGadgetAttribute(#Gadget_Models_Panel,#PB_Panel_ItemWidth),GetGadgetAttribute(#Gadget_Models_Panel,#PB_Panel_ItemHeight))
      ResizeGadget(#Gadget_Models_Image,0,0,GadgetWidth(#Gadget_Models_ImageContainer),GadgetHeight(#Gadget_Models_ImageContainer))
     Case #Gadget_MemoryChanger_Address
      Select EventType()
       Case #PB_EventType_Change
        SendMessage_(GadgetID(#Gadget_MemoryChanger_Address),#EM_GETSEL,@Pos1,@Pos2)
        SetGadgetText(#Gadget_MemoryChanger_Address,IsValidString(GetGadgetText(#Gadget_MemoryChanger_Address),"ABCDEF0123456789",1))
        SendMessage_(GadgetID(#Gadget_MemoryChanger_Address),#EM_SETSEL,Pos1,Pos2)
      EndSelect
     Case #Gadget_MemoryChanger_List
      Select EventType()
       Case #PB_EventType_LeftDoubleClick
        Item=GetGadgetState(#Gadget_MemoryChanger_List)
         If Item=-1
          MessageRequester(Language(19),Language(56),#MB_ICONERROR)
         Else
          SetGadgetText(#Gadget_MemoryChanger_Name,Trim(GetGadgetItemText(#Gadget_MemoryChanger_List,Item,0)))
          SetGadgetText(#Gadget_MemoryChanger_Address,UCase(Trim(GetGadgetItemText(#Gadget_MemoryChanger_List,Item,1))))
          SetGadgetState(#Gadget_MemoryChanger_DataType,GetGadgetItemData(#Gadget_MemoryChanger_List,Item))
          SetGadgetText(#Gadget_MemoryChanger_Value,Trim(GetGadgetItemText(#Gadget_MemoryChanger_List,Item,3)))
         EndIf
      EndSelect
     Case #Gadget_CleoManager_List
      Select EventType()
       Case #PB_EventType_RightClick
        DisplayPopupMenu(#Menu_CleoManager,WindowID(#Window_MDI_CleoManager))
      EndSelect
     Case #Gadget_IPLEditor_Files
      File$=GetGadgetText(#Gadget_IPLEditor_Files)
       If File$ And File$<>Config\IPLEditor_File
        If Config\IPLEditor_Changed
         Open=MessageRequester(Language(201),ReplaceString(ReplaceString(Language(202),"%1",Config\IPLEditor_File,1),"<br>",Chr(13),1),#MB_YESNO|#MB_ICONWARNING)
        Else
         Open=#PB_MessageRequester_Yes
        EndIf
        If Open=#PB_MessageRequester_Yes
         Config\IPLEditor_File=File$
         ClearGadgetItems(#Gadget_IPLEditor_List)
         IPL=0
         File$=GetPathPart(Common\GTAFile)+File$
         File=ReadFile(#PB_Any,File$)
          If IsFile(File)
           Repeat
            String$=Trim(ReadString(File))
             If String$
              Select LCase(String$)
               Case "inst"
                IPL=1
               Case "end"
                IPL=0
               Default
                If IPL
                 Item$=""
                 For Item=1 To 11
                  Item$+Trim(StringField(String$,Item,","))+Chr(10)
                 Next
                 AddGadgetItem(#Gadget_IPLEditor_List,-1,Item$)
                EndIf
              EndSelect
             EndIf
           Until Eof(File)
           CloseFile(File)
          EndIf
        EndIf
       EndIf
     Case #Gadget_IPLEditor_Save
      ; save
      MessageRequester("IPL Editor","Comming soon...")
      Config\IPLEditor_Changed=0
     Case #Gadget_IPLEditor_List
      Item=GetGadgetState(#Gadget_IPLEditor_List)
       If Item<>-1
        Select EventType()
         Case #PB_EventType_RightClick
          DisplayPopupMenu(#Menu_IPLEditor,WindowID(#Window_MDI_IPLEditor))
        EndSelect
       EndIf
     Case #Gadget_Config_OpenCheatSound
      File$=OpenFileRequester(Language(86),GetGadgetText(#Gadget_Config_CheatSound),"Sound|*.bmf;*.ogg;*.wav",0)
       If File$
        If IsFileEx(File$)
         SetGadgetText(#Gadget_Config_CheatSound,File$)
        Else
         MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
        EndIf
       EndIf
     Case #Gadget_Config_OpenGTAFile
      Path$=PathRequester(Language(46),GetPathPart(GetGadgetText(#Gadget_Config_GTAFile)))
       If Path$
        If IsFileEx(Path$+"gta_sa.exe")
         SetGadgetText(#Gadget_Config_GTAFile,Path$+"gta_sa.exe")
        Else
         MessageRequester(Language(19),ReplaceString(Language(124),"%1",Path$,1),#MB_ICONERROR)
        EndIf
       EndIf
     Case #Gadget_Config_CheatProcessorAdd
      Cheat$=UCase(Trim(InputRequester(Language(1),Language(76),"")))
       If Cheat$
        Add=1
        For Cheat=0 To CountGadgetItems(#Gadget_Config_CheatProcessorList)-1
         If UCase(GetGadgetItemText(#Gadget_Config_CheatProcessorList,Cheat))=Cheat$
          Add=0
         EndIf
        Next
        If Add
         AddGadgetItem(#Gadget_Config_CheatProcessorList,-1,Cheat$)
        Else
         MessageRequester(Language(19),ReplaceString(Language(65),"%1",Cheat$,1),#MB_ICONERROR)
        EndIf
       EndIf
     Case #Gadget_Config_CheatProcessorRemove
      Item=GetGadgetState(#Gadget_Config_CheatProcessorList)
       If Item<>-1
        RemoveGadgetItem(#Gadget_Config_CheatProcessorList,Item)
       EndIf
     Case #Gadget_Config_CheatProcessorClear
      If CountGadgetItems(#Gadget_Config_CheatProcessorList)
       If MessageRequester(Language(125),Language(126),#MB_YESNO|#MB_ICONQUESTION)=#PB_MessageRequester_Yes
        ClearGadgetItems(#Gadget_Config_CheatProcessorList)
       EndIf
      Else
       MessageRequester(Language(19),Language(127),#MB_ICONERROR)
      EndIf
     Case #Gadget_Config_OpenBackground
      File$=OpenFileRequester(Language(145),GetGadgetText(#Gadget_Config_Background),Language(146),0)
       If File$
        If IsFileEx(File$)
         SetGadgetText(#Gadget_Config_Background,File$)
        Else
         MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
        EndIf
       EndIf
     Case #Gadget_AddCheat_CheatSelect
      If GetGadgetState(#Gadget_AddCheat_CheatSelect)
       ResizeWindow(#Window_AddCheat,#PB_Ignore,#PB_Ignore,GadgetWidth(#Gadget_AddCheat_CheatSelectBox)+450,170)
       HideGadget(#Gadget_AddCheat_CheatSelectBox,0)
      Else
       ResizeWindow(#Window_AddCheat,#PB_Ignore,#PB_Ignore,440,170)
       HideGadget(#Gadget_AddCheat_CheatSelectBox,1)
      EndIf
     Case #Gadget_AddCheat_SoundSelect
      File$=OpenFileRequester(Language(25),GetGadgetText(#Gadget_AddCheat_Sound),"Sound|*.bmf;*.ogg;*.wav",0)
       If File$
        If IsFileEx(File$)
         SetGadgetText(#Gadget_AddCheat_Sound,File$)
        Else
         MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
        EndIf
       EndIf
     Case #Gadget_AddCheat_OK
      Cheat$=UCase(GetGadgetText(#Gadget_AddCheat_Cheat))
      Description$=GetGadgetText(#Gadget_AddCheat_Description)
      UseCtrl=0
      UseShift=0
      UseAlt=0
      Hotkey=0
      Sound$=GetGadgetText(#Gadget_AddCheat_Sound)
       If Cheat$ And Description$
        If GetGadgetState(#Gadget_AddCheat_Hotkey)
         If GetGadgetState(#Gadget_AddCheat_HotkeyCtrl)
          UseCtrl=1
         EndIf
         If GetGadgetState(#Gadget_AddCheat_HotkeyShift)
          UseShift=1
         EndIf
         If GetGadgetState(#Gadget_AddCheat_HotkeyAlt)
          UseAlt=1
         EndIf
         Hotkey=GetGadgetState(#Gadget_AddCheat_Hotkey)
        EndIf
        If AddCheat(Cheat$,Description$,Sound$,UseCtrl,UseShift,UseAlt,Hotkey,GetGadgetData(#Gadget_AddCheat_Cheat))
         CloseWindow(#Window_AddCheat)
         DisableWindow(#Window_Main,0)
        EndIf
       EndIf
     Case #Gadget_AddCheat_Cancel
      CloseWindow(#Window_AddCheat)
      DisableWindow(#Window_Main,0)
     Case #Gadget_Teleporter_EditCheat
      Select EventType()
       Case #PB_EventType_Change
        SendMessage_(GadgetID(#Gadget_Teleporter_EditCheat),#EM_GETSEL,@Pos1,@Pos2)
        SetGadgetText(#Gadget_Teleporter_EditCheat,IsValidString(GetGadgetText(#Gadget_Teleporter_EditCheat),"ABCDEFGHIJKLMNOPQRSTUVWXYZ_",1))
        SendMessage_(GadgetID(#Gadget_Teleporter_EditCheat),#EM_SETSEL,Pos1,Pos2)
      EndSelect
     Case #Gadget_Teleporter_EditX
      Select EventType()
       Case #PB_EventType_Change
        SendMessage_(GadgetID(#Gadget_Teleporter_EditX),#EM_GETSEL,@Pos1,@Pos2)
        SetGadgetText(#Gadget_Teleporter_EditX,IsValidString(GetGadgetText(#Gadget_Teleporter_EditX),"0123456789.-+"))
        SendMessage_(GadgetID(#Gadget_Teleporter_EditX),#EM_SETSEL,Pos1,Pos2)
      EndSelect
     Case #Gadget_Teleporter_EditY
      Select EventType()
       Case #PB_EventType_Change
        SendMessage_(GadgetID(#Gadget_Teleporter_EditY),#EM_GETSEL,@Pos1,@Pos2)
        SetGadgetText(#Gadget_Teleporter_EditY,IsValidString(GetGadgetText(#Gadget_Teleporter_EditY),"0123456789.-+"))
        SendMessage_(GadgetID(#Gadget_Teleporter_EditY),#EM_SETSEL,Pos1,Pos2)
      EndSelect
     Case #Gadget_Teleporter_EditZ
      Select EventType()
       Case #PB_EventType_Change
        SendMessage_(GadgetID(#Gadget_Teleporter_EditZ),#EM_GETSEL,@Pos1,@Pos2)
        SetGadgetText(#Gadget_Teleporter_EditZ,IsValidString(GetGadgetText(#Gadget_Teleporter_EditZ),"0123456789.-+"))
        SendMessage_(GadgetID(#Gadget_Teleporter_EditZ),#EM_SETSEL,Pos1,Pos2)
      EndSelect
     Case #Gadget_Teleporter_List
      Select EventType()
       Case #PB_EventType_LeftDoubleClick
         Item=GetGadgetState(#Gadget_Teleporter_List)
          If Item<>-1
           SetGadgetText(#Gadget_Teleporter_EditCheat,GetGadgetItemText(#Gadget_Teleporter_List,Item,0))
           SetGadgetText(#Gadget_Teleporter_EditX,GetGadgetItemText(#Gadget_Teleporter_List,Item,1))
           SetGadgetText(#Gadget_Teleporter_EditY,GetGadgetItemText(#Gadget_Teleporter_List,Item,2))
           SetGadgetText(#Gadget_Teleporter_EditZ,GetGadgetItemText(#Gadget_Teleporter_List,Item,3))
           SetGadgetState(#Gadget_Teleporter_EditInterior,GetGadgetItemData(#Gadget_Teleporter_List,Item)+1)
          EndIf
      EndSelect
     Case #Gadget_TeleportMap_Image
      Select EventType()
       Case #PB_EventType_LeftClick
        TeleportMap_SetPoint(GadgetMouse(#Gadget_TeleportMap_Image,0),GadgetMouse(#Gadget_TeleportMap_Image,1))
      EndSelect
     Case #Gadget_SavegameManager_List
      Select EventType()
       Case #PB_EventType_LeftDoubleClick
        SavegameEditor(1)
      EndSelect
     Case #Gadget_SavegameManager_Editor_Clock
      SavegameEditor_UpdateClock()
     Case #Gadget_About_Close
      DisableWindow(#Window_Main,0)
      CloseWindow(#Window_About)
     Case #Gadget_Help_Files
      Select EventType()
       Case #PB_EventType_LeftDoubleClick
        SelectElement(HelpPage(),GetGadgetState(#Gadget_Help_Files))
        If HelpPage()\File
         SetGadgetText(#Gadget_Help_Web,Config\HelpDir+HelpPage()\File)
         Config\HelpTopic=HelpPage()\File
        EndIf
      EndSelect
     Case #Gadget_GTAList_List
      Select EventType()
       Case #PB_EventType_LeftDoubleClick
        Item=GetGadgetState(#Gadget_GTAList_List)
         If Item<>-1
          File$=GetGadgetItemText(#Gadget_GTAList_List,Item,1)
           If IsFileEx(File$)
            RunProgram(File$,"",GetPathPart(File$))
           Else
            MessageRequester(Language(19),ReplaceString(Language(20),"%1",GetFilePart(File$),1),#MB_ICONERROR)
           EndIf
         EndIf
      EndSelect
     Case #Gadget_Login_OK
      SelfCodersAccount_Login()
     Case #Gadget_Login_Cancel
      CloseWindow(#Window_Login)
      DisableWindow(#Window_Main,0)
    EndSelect
   Case #PB_Event_GadgetDrop
    Select EventGadget()
     Case #Gadget_Tools_List
      Select EventDropType()
       Case #PB_Drop_Files
        Files$=Trim(EventDropFiles())
        For File=0 To CountString(Files$,Chr(10))
         File$=Trim(StringField(Files$,File+1,Chr(10)))
         If IsFileEx(File$)
          If LCase(GetExtensionPart(File$))="lnk"
           AddGadgetItem(#Gadget_Tools_List,-1,GetFileName(GetFilePart(File$))+Chr(10)+GetShellLinkInfo(File$,#ShellLinkInfo_FileName)+Chr(10)+GetShellLinkInfo(File$,#ShellLinkInfo_Parameter),ExtractIcon_(0,File$,0))
          EndIf
          AddGadgetItem(#Gadget_Tools_List,-1,GetFileName(GetFilePart(File$))+Chr(10)+File$,ExtractIcon_(0,File$,0))
         EndIf
        Next
        ReloadMenu()
      EndSelect
    EndSelect
   Case #PB_Event_SizeWindow
    Select EventWindow()
     Case #Window_Main
      If Config\UseTabs
       ResizeGadget(#Gadget_Main_Panel,0,0,WindowWidth(#Window_Main),20)
       y=20
      Else
       y=0
      EndIf
      ResizeGadget(#Gadget_Main_MDI,0,y,WindowWidth(#Window_Main),WindowHeight(#Window_Main)-MenuHeight()-StatusBarHeight(#StatusBar)-y)
      SetMDIImage()
     Case #Window_MDI_Cheats
      ResizeGadget(#Gadget_Cheats_List,0,ToolBarHeight(#ToolBar_Cheats),WindowWidth(#Window_MDI_Cheats),WindowHeight(#Window_MDI_Cheats)-ToolBarHeight(#ToolBar_Cheats))
     Case #Window_MDI_Teleporter
      ResizeGadget(#Gadget_Teleporter_EditContainer,0,ToolBarHeight(#ToolBar_Teleporter),WindowWidth(#Window_MDI_Teleporter),160)
      ResizeGadget(#Gadget_Teleporter_EditCheat,60,10,GadgetWidth(#Gadget_Teleporter_EditContainer)-70,20)
      ResizeGadget(#Gadget_Teleporter_EditX,60,40,GadgetWidth(#Gadget_Teleporter_EditCheat),20)
      ResizeGadget(#Gadget_Teleporter_EditY,60,70,GadgetWidth(#Gadget_Teleporter_EditCheat),20)
      ResizeGadget(#Gadget_Teleporter_EditZ,60,100,GadgetWidth(#Gadget_Teleporter_EditCheat),20)
      ResizeGadget(#Gadget_Teleporter_EditInterior,60,130,GadgetWidth(#Gadget_Teleporter_EditCheat),20)
      ResizeGadget(#Gadget_Teleporter_List,0,ToolBarHeight(#ToolBar_Teleporter)+GadgetHeight(#Gadget_Teleporter_EditContainer),WindowWidth(#Window_MDI_Teleporter),WindowHeight(#Window_MDI_Teleporter)-GadgetHeight(#Gadget_Teleporter_EditContainer)-ToolBarHeight(#ToolBar_Teleporter))
     Case #Window_MDI_SavegameManager
      ResizeGadget(#Gadget_SavegameManager_List,0,ToolBarHeight(#ToolBar_SavegameManager),WindowWidth(#Window_MDI_SavegameManager),WindowHeight(#Window_MDI_SavegameManager)-ToolBarHeight(#ToolBar_SavegameManager))
      ResizeGadget(#Gadget_SavegameManager_EditArea,0,ToolBarHeight(#ToolBar_SavegameManager),WindowWidth(#Window_MDI_SavegameManager),WindowHeight(#Window_MDI_SavegameManager)-ToolBarHeight(#ToolBar_SavegameManager))
     Case #Window_MDI_Models
      ResizeGadget(#Gadget_Models_Splitter,0,ToolBarHeight(#ToolBar_Models),WindowWidth(#Window_MDI_Models),WindowHeight(#Window_MDI_Models)-ToolBarHeight(#ToolBar_Models))
     Case #Window_MDI_MemoryChanger
      ResizeGadget(#Gadget_MemoryChanger_EditContainer,0,ToolBarHeight(#ToolBar_MemoryChanger),WindowWidth(#Window_MDI_MemoryChanger),130)
      ResizeGadget(#Gadget_MemoryChanger_Name,70,10,GadgetWidth(#Gadget_MemoryChanger_EditContainer)-80,20)
      ResizeGadget(#Gadget_MemoryChanger_Address,70,40,GadgetWidth(#Gadget_MemoryChanger_EditContainer)-80,20)
      ResizeGadget(#Gadget_MemoryChanger_DataType,70,70,GadgetWidth(#Gadget_MemoryChanger_EditContainer)-80,20)
      ResizeGadget(#Gadget_MemoryChanger_Value,70,100,GadgetWidth(#Gadget_MemoryChanger_EditContainer)-80,20)
      ResizeGadget(#Gadget_MemoryChanger_List,0,GadgetHeight(#Gadget_MemoryChanger_EditContainer)+ToolBarHeight(#ToolBar_MemoryChanger),WindowWidth(#Window_MDI_MemoryChanger),WindowHeight(#Window_MDI_MemoryChanger)-GadgetHeight(#Gadget_MemoryChanger_EditContainer)-ToolBarHeight(#ToolBar_MemoryChanger))
     Case #Window_MDI_IMGEditor
      ResizeGadget(#Gadget_IMGEditor_List,0,ToolBarHeight(#ToolBar_IMGEditor),WindowWidth(#Window_MDI_IMGEditor),WindowHeight(#Window_MDI_IMGEditor)-ToolBarHeight(#ToolBar_IMGEditor)-20)
      ResizeGadget(#Gadget_IMGEditor_Progress,0,WindowHeight(#Window_MDI_IMGEditor)-20,WindowWidth(#Window_MDI_IMGEditor),20)
     Case #Window_MDI_CleoManager
      ResizeGadget(#Gadget_CleoManager_List,0,ToolBarHeight(#ToolBar_CleoManager),WindowWidth(#Window_MDI_CleoManager),WindowHeight(#Window_MDI_CleoManager)-ToolBarHeight(#ToolBar_CleoManager))
     Case #Window_MDI_IPLEditor
      ResizeGadget(#Gadget_IPLEditor_Files,0,0,200,20)
      ResizeGadget(#Gadget_IPLEditor_Save,WindowWidth(#Window_MDI_IPLEditor)-150,0,150,20)
      ResizeGadget(#Gadget_IPLEditor_List,0,20,WindowWidth(#Window_MDI_IPLEditor),WindowHeight(#Window_MDI_IPLEditor)-20)
     Case #Window_MDI_GameTweaks
      ResizeGadget(#Gadget_GameTweaks_Panel,0,ToolBarHeight(#ToolBar_GameTweaks),WindowWidth(#Window_MDI_GameTweaks),WindowHeight(#Window_MDI_GameTweaks)-ToolBarHeight(#ToolBar_GameTweaks))
      ResizeGadget(#Gadget_GameTweaks_StatisticScroll,0,0,GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemWidth),GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemHeight))
      SetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth,GadgetWidth(#Gadget_GameTweaks_StatisticScroll))
      ResizeGadget(#Gadget_GameTweaks_PistolState,170,10,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_SilencedPistolState,170,50,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_DesertEagleState,170,80,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_ShotgunState,170,110,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_SawnoffShotgunState,170,140,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_CombatShotgunState,170,170,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_MachinePistolState,170,200,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_SMGState,170,230,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_AK47State,170,260,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_M4State,170,290,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_FatState,170,340,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_StaminaState,170,370,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_MuscleState,170,400,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_HealthState,170,430,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_SexAppealState,170,460,GetGadgetAttribute(#Gadget_GameTweaks_StatisticScroll,#PB_ScrollArea_InnerWidth)-180,20)
      ResizeGadget(#Gadget_GameTweaks_GirlfriendsScroll,0,0,GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemWidth),GetGadgetAttribute(#Gadget_GameTweaks_Panel,#PB_Panel_ItemHeight))
      SetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth,GadgetWidth(#Gadget_GameTweaks_GirlfriendsScroll))
      ResizeGadget(#Gadget_GameTweaks_DeniseState,120,10,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20)
      ResizeGadget(#Gadget_GameTweaks_MichelleState,120,40,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20)
      ResizeGadget(#Gadget_GameTweaks_HelenaState,120,70,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20)
      ResizeGadget(#Gadget_GameTweaks_BarbaraState,120,100,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20)
      ResizeGadget(#Gadget_GameTweaks_KatieState,120,130,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20)
      ResizeGadget(#Gadget_GameTweaks_MillieState,120,160,GetGadgetAttribute(#Gadget_GameTweaks_GirlfriendsScroll,#PB_ScrollArea_InnerWidth)-130,20)
     Case #Window_MDI_Config
      ResizeGadget(#Gadget_Config_ScrollArea,0,ToolBarHeight(#ToolBar_Config),WindowWidth(#Window_MDI_Config),WindowHeight(#Window_MDI_Config)-ToolBarHeight(#ToolBar_Config))
     Case #Window_MDI_Tools
      ResizeGadget(#Gadget_Tools_List,0,ToolBarHeight(#ToolBar_Tools),WindowWidth(#Window_MDI_Tools),WindowHeight(#Window_MDI_Tools)-ToolBarHeight(#ToolBar_Tools))
     Case #Window_MDI_TeleportMap
      ResizeGadget(#Gadget_TeleportMap_ScrollArea,0,0,WindowWidth(#Window_MDI_TeleportMap),WindowHeight(#Window_MDI_TeleportMap))
     Case #Window_MDI_Help
      ResizeGadget(#Gadget_Help_Frame,0,ToolBarHeight(#ToolBar_Help),WindowWidth(#Window_MDI_Help),WindowHeight(#Window_MDI_Help)-ToolBarHeight(#ToolBar_Help))
      ResizeGadget(#Gadget_Help_Splitter,0,0,GadgetWidth(#Gadget_Help_Frame),GadgetHeight(#Gadget_Help_Frame))
     Case #Window_MDI_ChangeLog
      ResizeGadget(#Gadget_ChangeLog_Text,0,0,WindowWidth(#Window_MDI_ChangeLog),WindowHeight(#Window_MDI_ChangeLog))
     Case #Window_GTAList
      ResizeGadget(#Gadget_GTAList_List,0,0,WindowWidth(#Window_GTAList),WindowHeight(#Window_GTAList))
    EndSelect
   Case #PB_Event_CloseWindow
    Window=EventWindow()
    Select Window
     Case #Window_Main
      Quit()
     Case #Window_MDI_Cheats,#Window_MDI_Teleporter,#Window_MDI_SavegameManager,#Window_MDI_Models,#Window_MDI_MemoryChanger,#Window_MDI_IMGEditor,#Window_MDI_CleoManager,#Window_MDI_IPLEditor,#Window_MDI_GameTweaks,#Window_MDI_Config,#Window_MDI_Tools
      SetWindowState(Window,#PB_Window_Normal)
      HideWindow(Window,1)
      RefreshWindowMenu()
     Case #Window_MDI_TeleportMap
      CloseMDIWindow(#Window_MDI_TeleportMap)
     Case #Window_MDI_Help
      CloseMDIWindow(#Window_MDI_Help)
     Case #Window_MDI_ChangeLog
      CloseMDIWindow(#Window_MDI_ChangeLog)
     Case #Window_GTAList
      CloseWindow(#Window_GTAList)
    EndSelect
   Case #PB_Event_SysTray
    Select EventType()
     Case #PB_EventType_LeftClick
      RestoreWindow()
     Case #PB_EventType_RightClick
      DisplayPopupMenu(#Menu_Tray,WindowID(#Window_Main))
    EndSelect
  EndSelect
 Until Config\Quit=#PB_MessageRequester_Yes
 If Config\CloseModulesOnQuit
  SendMessage(#Module_CheatProcessor,#Module_CMD_Quit)
  SendMessage(#Module_MemoryServer,#Module_CMD_Quit)
  SendMessage(#Module_WebServer,#Module_CMD_Quit)
 EndIf
 If IsThread(Config\Thread_RefreshUserTrackList)
  ID=Config\Thread_RefreshUserTrackList
  Config\Thread_RefreshUserTrackList=0
  For Timeout=1 To 10000
   If IsThread(ID)=0
    Break
   EndIf
   Delay(1)
   WindowEvent()
  Next
  If IsThread(ID)
   KillThread(ID)
  EndIf
 EndIf
 SaveSettings()
 RemoveSysTrayIcon(#Tray)
EndIf